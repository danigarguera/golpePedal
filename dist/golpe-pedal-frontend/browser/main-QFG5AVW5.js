import{a as ge}from"./chunk-NBXJKE54.js";import{a as _e}from"./chunk-IN4BUU5G.js";import{a as fe}from"./chunk-4GUMZMTI.js";import{a as we}from"./chunk-GZI56UPR.js";import{a as J,b as I,c as L,d as Y,e as ve,f as oe,g as X,i as be,j as Ce,k as lt,l as st,m as mt,o as ne,p as ct,q as xe,r as he,s as Se,t as re,u as ye}from"./chunk-ND65VQ52.js";import{a as G}from"./chunk-45IF2TN7.js";import{a as dt}from"./chunk-ATC3HXFD.js";import{$ as y,Aa as ot,B as C,Ba as nt,C as h,Ca as ue,Da as F,Ea as k,Fa as rt,G as g,Ga as at,Ha as O,I as qe,Ia as $,J as m,K as U,L as Ge,M as n,N as o,O as p,P as $e,Q as Je,R as x,S as v,T as d,U as je,V as P,W as l,X as b,Y as D,Z as Ye,_ as Xe,aa as w,ba as E,da as Ze,ea as T,ga as W,h as ze,ha as Ke,ia as q,ja as ee,k as H,n as j,o as de,pa as pe,q as u,qa as A,r as f,ra as M,sa as Qe,ta as te,ua as S,v as He,va as et,wa as tt,y as ce,ya as ie,z as s,za as it}from"./chunk-YAXSTRSO.js";function vt(t,i){if(t&1){let e=x();n(0,"img",21),v("click",function(){u(e);let a=d().$implicit,c=d();return f(c.verDetalle(a.id))})("error",function(){u(e);let a=d().$implicit,c=d();return f(c.marcarImagenComoFallida(a.id))}),o()}if(t&2){let e=d().$implicit,r=d();je("alt",e.nombre),m("src",r.apiUrl+"/componentes/"+e.id+"/imagen",ce)}}function bt(t,i){if(t&1){let e=x();n(0,"img",22),v("click",function(){u(e);let a=d().$implicit,c=d();return f(c.verDetalle(a.id))}),o()}}function Ct(t,i){if(t&1&&(n(0,"div",16)(1,"div",17),g(2,vt,1,2,"img",18)(3,bt,1,0,"img",19),n(4,"div",20)(5,"h5"),l(6),o(),n(7,"p"),l(8),o()()()()),t&2){let e=i.$implicit,r=i.index,a=d();U("active",r===0),s(2),m("ngIf",!a.imagenFallida[e.id]),s(),m("ngIf",a.imagenFallida[e.id]),s(3),b(e.nombre),s(2),b(e.descripcion)}}function xt(t,i){if(t&1){let e=x();n(0,"img",33),v("error",function(){u(e);let a=d().$implicit,c=d();return f(c.marcarImagenComoFallida(a.id))}),o()}if(t&2){let e=d().$implicit,r=d();je("alt",e.nombre),m("src",r.apiUrl+"/componentes/"+e.id+"/imagen",ce)}}function ht(t,i){t&1&&p(0,"img",34)}function St(t,i){if(t&1){let e=x();n(0,"div",23)(1,"div",24),g(2,xt,1,2,"img",25)(3,ht,1,0,"img",26),n(4,"div",27)(5,"h5",28),l(6),o(),n(7,"p",29),l(8),o(),n(9,"div",30)(10,"button",31),v("click",function(){let a=u(e).$implicit,c=d();return f(c.verDetalle(a.id))}),l(11," Ver detalle "),o(),n(12,"button",32),v("click",function(){let a=u(e).$implicit,c=d();return f(c.agregarAlCarrito(a))}),l(13," A\xF1adir al carrito "),o()()()()()}if(t&2){let e=i.$implicit,r=d();s(2),m("ngIf",!r.imagenFallida[e.id]),s(),m("ngIf",r.imagenFallida[e.id]),s(3),b(e.nombre),s(2),b(e.descripcion)}}var Ee=class t{constructor(i,e,r){this.router=i;this.componentesService=e;this.carritoService=r}bicicletas=[];destacados=[];apiUrl=$.apiUrl;imagenFallida={};ngOnInit(){this.componentesService.obtenerComponentes().subscribe(i=>{let e=i.filter(r=>r.tipo?.toLowerCase()==="bicicleta");this.bicicletas=e,this.destacados=this.seleccionarAleatorios(i,6)})}seleccionarAleatorios(i,e){let r=[...i],a=[];for(;a.length<e&&r.length>0;){let c=Math.floor(Math.random()*r.length);a.push(r.splice(c,1)[0])}return a}verDetalle(i){this.router.navigate(["/componentes",i])}marcarImagenComoFallida(i){this.imagenFallida[i]=!0}agregarAlCarrito(i){this.carritoService.agregarProducto(i)}static \u0275fac=function(e){return new(e||t)(C(F),C(_e),C(G))};static \u0275cmp=h({type:t,selectors:[["app-home"]],decls:20,vars:2,consts:[[1,"container","py-4"],[1,"text-center","mb-5"],[1,"display-5","fw-bold","texto-grande",2,"font-family","$fuente-principal"],[1,"lead",2,"font-family","$fuente-secundaria"],["id","carouselBicicletas","data-bs-ride","carousel",1,"carousel","slide","mb-5","sombra-suave"],[1,"carousel-inner"],["class","carousel-item",3,"active",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselBicicletas","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],["type","button","data-bs-target","#carouselBicicletas","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"text-center","mb-4","texto-grande"],[1,"row"],["class","col-md-4 mb-4",4,"ngFor","ngForOf"],[1,"text-center","mt-4"],["routerLink","/componentes",1,"btn","btn-secundario","btn-lg"],[1,"carousel-item"],[1,"contenedor-carrusel","tarjeta-carrusel","text-center"],[3,"src","alt","click","error",4,"ngIf"],["src","assets/img/imagen-no-disponible.webp","alt","Imagen no disponible",3,"click",4,"ngIf"],[1,"descripcion-carrusel","mt-3"],[3,"click","error","src","alt"],["src","assets/img/imagen-no-disponible.webp","alt","Imagen no disponible",3,"click"],[1,"col-md-4","mb-4"],[1,"card","h-100","sombra-suave","borde-claro","text-center"],["class","card-img-top","style","object-fit: cover; max-height: 200px;",3,"src","alt","error",4,"ngIf"],["src","assets/img/imagen-no-disponible.webp","class","card-img-top","alt","Imagen no disponible","style","object-fit: cover; max-height: 200px;",4,"ngIf"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"btn","btn-sm","btn-primario",3,"click"],[1,"btn","btn-sm","btn-secundario",3,"click"],[1,"card-img-top",2,"object-fit","cover","max-height","200px",3,"error","src","alt"],["src","assets/img/imagen-no-disponible.webp","alt","Imagen no disponible",1,"card-img-top",2,"object-fit","cover","max-height","200px"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),l(3," \xA1Bienvenido a Golpe de Pedal! "),o(),n(4,"p",3),l(5," Energ\xEDa y tecnolog\xEDa para tu bicicleta. Explora nuestras bicicletas y componentes de calidad. "),o()(),n(6,"div",4)(7,"div",5),g(8,Ct,9,6,"div",6),o(),n(9,"button",7),p(10,"span",8),o(),n(11,"button",9),p(12,"span",10),o()(),n(13,"h2",11),l(14,"Componentes destacados"),o(),n(15,"div",12),g(16,St,14,4,"div",13),o(),n(17,"div",14)(18,"a",15),l(19,"Ver todos los componentes"),o()()()),e&2&&(s(8),m("ngForOf",r.bicicletas),s(8),m("ngForOf",r.destacados))},dependencies:[S,A,M,k],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif}p.lead[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;color:#333}.carousel[_ngcontent-%COMP%]{width:100%}.tarjeta-carrusel[_ngcontent-%COMP%]{max-width:800px;width:90%;margin:0 auto;padding:1rem;background-color:#fff;border-radius:1rem;box-shadow:0 2px 8px #0000001a;display:flex;flex-direction:column;align-items:center}.tarjeta-carrusel[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:400px;object-fit:contain;border-radius:.5rem;cursor:pointer}@media (max-width: 768px){.tarjeta-carrusel[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:240px}}.descripcion-carrusel[_ngcontent-%COMP%]{background-color:#00000080;color:#fff;padding:1rem;border-radius:.75rem;font-family:Open Sans,sans-serif;margin-top:1rem;text-align:center}.card-title[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif;font-weight:700}.card-text[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;font-size:.9rem;color:#333}.card-img-top[_ngcontent-%COMP%]{object-fit:cover;height:200px;width:100%;border-radius:.5rem}@media (max-width: 576px){.card-img-top[_ngcontent-%COMP%]{height:160px}}"]})};var K=class extends Error{};K.prototype.name="InvalidTokenError";function yt(t){return decodeURIComponent(atob(t).replace(/(.)/g,(i,e)=>{let r=e.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}function wt(t){let i=t.replace(/-/g,"+").replace(/_/g,"/");switch(i.length%4){case 0:break;case 2:i+="==";break;case 3:i+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return yt(i)}catch{return atob(i)}}function Me(t,i){if(typeof t!="string")throw new K("Invalid token specified: must be a string");i||(i={});let e=i.header===!0?0:1,r=t.split(".")[e];if(typeof r!="string")throw new K(`Invalid token specified: missing part #${e+1}`);let a;try{a=wt(r)}catch(c){throw new K(`Invalid token specified: invalid base64 for part #${e+1} (${c.message})`)}try{return JSON.parse(a)}catch(c){throw new K(`Invalid token specified: invalid json for part #${e+1} (${c.message})`)}}var Ie=class t{constructor(i){this.http=i}apiUrl=`${$.apiUrl}/auth/login`;login(i,e){return this.http.post(this.apiUrl,{email:i,password:e}).pipe(ze(r=>{localStorage.setItem("token",r.token),console.log("\u2705 Token guardado en localStorage:",r.token)}))}logout(){localStorage.removeItem("token")}isLoggedIn(){return!!localStorage.getItem("token")}getToken(){return localStorage.getItem("token")}static \u0275fac=function(e){return new(e||t)(j(ie))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};var ae=class t{constructor(i){this.http=i}apiUrl=`${$.apiUrl}/auth/register`;registrar(i){return this.http.post(this.apiUrl,i)}static \u0275fac=function(e){return new(e||t)(j(ie))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};function Mt(t,i){if(t&1&&(n(0,"div",20),l(1),o()),t&2){let e=d(2);s(),b(e.error)}}function It(t,i){if(t&1){let e=x();n(0,"form",11),v("ngSubmit",function(){u(e);let a=d();return f(a.login())}),n(1,"div",12)(2,"label"),l(3,"Email"),o(),n(4,"input",13),E("ngModelChange",function(a){u(e);let c=d();return w(c.email,a)||(c.email=a),f(a)}),o()(),n(5,"div",12)(6,"label"),l(7,"Contrase\xF1a"),o(),n(8,"input",14),E("ngModelChange",function(a){u(e);let c=d();return w(c.password,a)||(c.password=a),f(a)}),o()(),n(9,"button",15),p(10,"i",16),l(11," Iniciar sesi\xF3n "),o(),n(12,"button",17),v("click",function(){u(e);let a=d();return f(a.continuarSinRegistrarse())}),p(13,"i",18),l(14," Continuar sin registrarse "),o(),g(15,Mt,2,1,"div",19),o()}if(t&2){let e=d();s(4),y("ngModel",e.email),s(4),y("ngModel",e.password),s(7),m("ngIf",e.error)}}function Dt(t,i){if(t&1&&(n(0,"div",30),l(1),o()),t&2){let e=d(2);s(),b(e.mensaje)}}function Pt(t,i){if(t&1&&(n(0,"div",20),l(1),o()),t&2){let e=d(2);s(),b(e.error)}}function Tt(t,i){if(t&1){let e=x();n(0,"form",21),v("ngSubmit",function(){u(e);let a=d();return f(a.registrarUsuario())}),n(1,"div",12)(2,"label"),l(3,"Nombre"),o(),n(4,"input",22),E("ngModelChange",function(a){u(e);let c=d();return w(c.usuario.nombre,a)||(c.usuario.nombre=a),f(a)}),o()(),n(5,"div",12)(6,"label"),l(7,"Primer Apellido"),o(),n(8,"input",23),E("ngModelChange",function(a){u(e);let c=d();return w(c.usuario.apellido1,a)||(c.usuario.apellido1=a),f(a)}),o()(),n(9,"div",12)(10,"label"),l(11,"Segundo Apellido"),o(),n(12,"input",24),E("ngModelChange",function(a){u(e);let c=d();return w(c.usuario.apellido2,a)||(c.usuario.apellido2=a),f(a)}),o()(),n(13,"div",12)(14,"label"),l(15,"DNI"),o(),n(16,"input",25),E("ngModelChange",function(a){u(e);let c=d();return w(c.usuario.dni,a)||(c.usuario.dni=a),f(a)}),o()(),n(17,"div",12)(18,"label"),l(19,"Tel\xE9fono"),o(),n(20,"input",26),E("ngModelChange",function(a){u(e);let c=d();return w(c.usuario.telefono,a)||(c.usuario.telefono=a),f(a)}),o()(),n(21,"div",12)(22,"label"),l(23,"Email"),o(),n(24,"input",13),E("ngModelChange",function(a){u(e);let c=d();return w(c.usuario.email,a)||(c.usuario.email=a),f(a)}),o()(),n(25,"div",12)(26,"label"),l(27,"Contrase\xF1a"),o(),n(28,"input",27),E("ngModelChange",function(a){u(e);let c=d();return w(c.usuario.password,a)||(c.usuario.password=a),f(a)}),o()(),n(29,"button",15),p(30,"i",28),l(31," Registrarse "),o(),g(32,Dt,2,1,"div",29)(33,Pt,2,1,"div",19),o()}if(t&2){let e=d();s(4),y("ngModel",e.usuario.nombre),s(4),y("ngModel",e.usuario.apellido1),s(4),y("ngModel",e.usuario.apellido2),s(4),y("ngModel",e.usuario.dni),s(4),y("ngModel",e.usuario.telefono),s(4),y("ngModel",e.usuario.email),s(4),y("ngModel",e.usuario.password),s(4),m("ngIf",e.mensaje),s(),m("ngIf",e.error)}}var De=class t{constructor(i,e,r,a){this.loginService=i;this.registroService=e;this.carritoService=r;this.router=a}email="";password="";error="";mensaje="";mostrarRegistro=!1;usuario={nombre:"",apellido1:"",apellido2:"",dni:"",telefono:"",email:"",password:""};login(){this.error="",this.loginService.login(this.email,this.password).subscribe({next:i=>{localStorage.setItem("token",i.token),this.carritoService.refrescarContador?.();let e=Me(i.token),r=e?.rol||e?.authorities?.[0]?.authority;this.router.navigate([r==="ROLE_ADMIN"||r==="ROLE_EMPLEADO"?"/dashboard":"/"])},error:()=>{this.error="Email o contrase\xF1a incorrectos."}})}registrarUsuario(){this.error="",this.mensaje="",this.registroService.registrar(this.usuario).subscribe({next:i=>{localStorage.setItem("token",i.token),this.mensaje="\xA1Usuario registrado exitosamente!",this.router.navigate(["/"])},error:i=>{this.error=i.error?.error||"Error al registrar."}})}toggleRegistro(){this.mostrarRegistro=!this.mostrarRegistro,this.error="",this.mensaje=""}continuarSinRegistrarse(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||t)(C(Ie),C(ae),C(G),C(F))};static \u0275cmp=h({type:t,selectors:[["app-login"]],decls:16,vars:7,consts:[[1,"modal-backdrop","show","fade",2,"background","rgba(0,0,0,0.5)","position","fixed","inset","0","z-index","1040"],["tabindex","-1",1,"modal","d-block"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","p-4","rounded-4","sombra-suave"],[1,"modal-header","border-0"],[1,"modal-title","texto-grande"],[1,"modal-body"],[3,"ngSubmit",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[1,"modal-footer","border-0","justify-content-between"],[1,"btn","btn-secundario","btn-sm",3,"click"],[3,"ngSubmit"],[1,"mb-3"],["type","email","name","email","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["type","password","name","password","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primario","w-100"],[1,"bi","bi-box-arrow-in-right","me-2"],["type","button",1,"btn","btn-primario-invertido","w-100","mt-3",3,"click"],[1,"bi","bi-box-arrow-right","me-2"],["class","text-danger mt-2",4,"ngIf"],[1,"text-danger","mt-2"],["novalidate","",3,"ngSubmit"],["type","text","name","nombre","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["type","text","name","apellido1","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["type","text","name","apellido2",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["type","text","name","dni","required","","pattern","^[0-9]{8}[A-Z]$",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["type","text","name","telefono","required","","pattern","^[0-9]{9}$",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["type","password","name","password","required","","minlength","6",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],[1,"bi","bi-person-check"],["class","text-success mt-2",4,"ngIf"],[1,"text-success","mt-2"]],template:function(e,r){e&1&&(p(0,"div",0),n(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5),l(6),o()(),n(7,"div",6),g(8,It,16,3,"form",7)(9,Tt,34,9,"form",8),o(),n(10,"div",9)(11,"span"),l(12),o(),n(13,"button",10),v("click",function(){return r.toggleRegistro()}),p(14,"i"),l(15),o()()()()()),e&2&&(s(6),D(" ",r.mostrarRegistro?"Registro de Usuario":"Iniciar Sesi\xF3n"," "),s(2),m("ngIf",!r.mostrarRegistro),s(),m("ngIf",r.mostrarRegistro),s(3),b(r.mostrarRegistro?"\xBFYa tienes cuenta?":"\xBFNo tienes cuenta?"),s(2),Ge(r.mostrarRegistro?"bi bi-box-arrow-in-left":"bi bi-person-plus"),s(),D(" ",r.mostrarRegistro?"Volver a login":"Crear cuenta"," "))},dependencies:[S,M,re,X,J,L,Y,ne,xe,he,oe,ve],encapsulation:2})};function Ft(t,i){t&1&&(n(0,"div",30),l(1," \u23F3 Registrando usuario, por favor espera... "),o())}function Vt(t,i){t&1&&(n(0,"div"),l(1,"El DNI es obligatorio."),o())}function kt(t,i){t&1&&(n(0,"div"),l(1,"Formato inv\xE1lido (ej: 12345678A)."),o())}function Ot(t,i){t&1&&(n(0,"div"),l(1,"El tel\xE9fono es obligatorio."),o())}function Rt(t,i){t&1&&(n(0,"div"),l(1,"Debe tener 9 d\xEDgitos num\xE9ricos."),o())}function At(t,i){t&1&&(n(0,"div"),l(1,"El email es obligatorio."),o())}function Lt(t,i){t&1&&(n(0,"div"),l(1,"Debe ser un email v\xE1lido."),o())}function Nt(t,i){t&1&&(n(0,"div"),l(1,"La contrase\xF1a es obligatoria."),o())}function jt(t,i){t&1&&(n(0,"div"),l(1,"M\xEDnimo 6 caracteres."),o())}var Te=class t{constructor(i,e){this.registroService=i;this.router=e}usuario={nombre:"",apellido1:"",apellido2:"",dni:"",telefono:"",email:"",password:""};mensaje="";error="";cargando=!1;registrarUsuario(){this.cargando=!0,this.registroService.registrar(this.usuario).subscribe({next:i=>{console.log("\u2705 Usuario registrado:",i),localStorage.setItem("token",i.token),this.mensaje="\u2705 \xA1Usuario registrado exitosamente!",this.error="",this.usuario={nombre:"",apellido1:"",apellido2:"",dni:"",telefono:"",email:"",password:""},this.cargando=!1,this.router.navigate(["/"])},error:i=>{console.error("\u274C Error al registrar:",i),this.error=i.error?.error||"\u274C Error: El usuario ya existe o hubo un problema.",this.mensaje="",this.cargando=!1}})}static \u0275fac=function(e){return new(e||t)(C(ae),C(F))};static \u0275cmp=h({type:t,selectors:[["app-registro"]],decls:59,vars:29,consts:[["registroForm","ngForm"],["nombre","ngModel"],["apellido1","ngModel"],["apellido2","ngModel"],["dni","ngModel"],["telefono","ngModel"],["email","ngModel"],["password","ngModel"],[1,"container","mt-5"],[1,"text-center"],["class","alert alert-info text-center","role","alert",4,"ngIf"],["novalidate","",1,"mt-4",3,"ngSubmit"],[1,"mb-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","name","nombre","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"invalid-feedback"],["for","apellido1",1,"form-label"],["type","text","id","apellido1","name","apellido1","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","apellido2",1,"form-label"],["type","text","id","apellido2","name","apellido2",1,"form-control",3,"ngModelChange","ngModel"],["for","dni",1,"form-label"],["type","text","id","dni","name","dni","required","","pattern","^[0-9]{8}[A-Z]$",1,"form-control",3,"ngModelChange","ngModel"],[4,"ngIf"],["for","telefono",1,"form-label"],["type","text","id","telefono","name","telefono","required","","pattern","^[0-9]{9}$",1,"form-control",3,"ngModelChange","ngModel"],["for","email",1,"form-label"],["type","email","id","email","name","email","required","","email","",1,"form-control",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],["type","password","id","password","name","password","required","","minlength","6",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","w-100",3,"disabled"],["role","alert",1,"alert","alert-info","text-center"]],template:function(e,r){if(e&1){let a=x();n(0,"div",8)(1,"h2",9),l(2,"Registro de Usuario"),o(),g(3,Ft,2,0,"div",10),n(4,"form",11,0),v("ngSubmit",function(){return u(a),f(r.registrarUsuario())}),n(6,"div",12)(7,"label",13),l(8,"Nombre"),o(),n(9,"input",14,1),E("ngModelChange",function(_){return u(a),w(r.usuario.nombre,_)||(r.usuario.nombre=_),f(_)}),o(),n(11,"div",15),l(12,"El nombre es obligatorio."),o()(),n(13,"div",12)(14,"label",16),l(15,"Primer Apellido"),o(),n(16,"input",17,2),E("ngModelChange",function(_){return u(a),w(r.usuario.apellido1,_)||(r.usuario.apellido1=_),f(_)}),o(),n(18,"div",15),l(19,"El primer apellido es obligatorio."),o()(),n(20,"div",12)(21,"label",18),l(22,"Segundo Apellido (opcional)"),o(),n(23,"input",19,3),E("ngModelChange",function(_){return u(a),w(r.usuario.apellido2,_)||(r.usuario.apellido2=_),f(_)}),o()(),n(25,"div",12)(26,"label",20),l(27,"DNI"),o(),n(28,"input",21,4),E("ngModelChange",function(_){return u(a),w(r.usuario.dni,_)||(r.usuario.dni=_),f(_)}),o(),n(30,"div",15),g(31,Vt,2,0,"div",22)(32,kt,2,0,"div",22),o()(),n(33,"div",12)(34,"label",23),l(35,"Tel\xE9fono"),o(),n(36,"input",24,5),E("ngModelChange",function(_){return u(a),w(r.usuario.telefono,_)||(r.usuario.telefono=_),f(_)}),o(),n(38,"div",15),g(39,Ot,2,0,"div",22)(40,Rt,2,0,"div",22),o()(),n(41,"div",12)(42,"label",25),l(43,"Email"),o(),n(44,"input",26,6),E("ngModelChange",function(_){return u(a),w(r.usuario.email,_)||(r.usuario.email=_),f(_)}),o(),n(46,"div",15),g(47,At,2,0,"div",22)(48,Lt,2,0,"div",22),o()(),n(49,"div",12)(50,"label",27),l(51,"Contrase\xF1a"),o(),n(52,"input",28,7),E("ngModelChange",function(_){return u(a),w(r.usuario.password,_)||(r.usuario.password=_),f(_)}),o(),n(54,"div",15),g(55,Nt,2,0,"div",22)(56,jt,2,0,"div",22),o()(),n(57,"button",29),l(58,"Registrarse"),o()()()}if(e&2){let a=P(5),c=P(10),_=P(17),R=P(29),le=P(37),se=P(45),me=P(53);s(3),m("ngIf",r.cargando),s(6),U("is-invalid",a.submitted&&c.invalid),y("ngModel",r.usuario.nombre),s(7),U("is-invalid",a.submitted&&_.invalid),y("ngModel",r.usuario.apellido1),s(7),y("ngModel",r.usuario.apellido2),s(5),U("is-invalid",a.submitted&&R.invalid),y("ngModel",r.usuario.dni),s(3),m("ngIf",R.errors==null?null:R.errors.required),s(),m("ngIf",R.errors==null?null:R.errors.pattern),s(4),U("is-invalid",a.submitted&&le.invalid),y("ngModel",r.usuario.telefono),s(3),m("ngIf",le.errors==null?null:le.errors.required),s(),m("ngIf",le.errors==null?null:le.errors.pattern),s(4),U("is-invalid",a.submitted&&se.invalid),y("ngModel",r.usuario.email),s(3),m("ngIf",se.errors==null?null:se.errors.required),s(),m("ngIf",se.errors==null?null:se.errors.email),s(4),U("is-invalid",a.submitted&&me.invalid),y("ngModel",r.usuario.password),s(3),m("ngIf",me.errors==null?null:me.errors.required),s(),m("ngIf",me.errors==null?null:me.errors.minlength),s(),m("disabled",a.invalid)}},dependencies:[re,X,J,L,Y,ne,xe,he,ct,oe,ve,S,M],encapsulation:2})};var We=t=>["/componentes",t],Ut=t=>[t,"EUR","symbol","1.2-2","es-ES"];function Wt(t,i){if(t&1){let e=x();n(0,"img",11),v("error",function(){u(e);let a=d();return f(a.marcarImagenComoFallida(a.producto.id))}),o()}if(t&2){let e=d();m("src",e.apiUrl+"/componentes/"+e.producto.id+"/imagen",ce)("alt","Imagen de "+e.producto.nombre)}}function Bt(t,i){t&1&&p(0,"img",12)}var Fe=class t{constructor(i){this.carritoService=i}producto;productoA\u00F1adido=new He;apiUrl=$.apiUrl;imagenFallida={};agregarAlCarrito(i){i.stopPropagation(),this.carritoService.agregarProducto(this.producto),this.productoA\u00F1adido.emit()}marcarImagenComoFallida(i){this.imagenFallida[i]=!0}static \u0275fac=function(e){return new(e||t)(C(G))};static \u0275cmp=h({type:t,selectors:[["app-tarjeta-producto"]],inputs:{producto:"producto"},outputs:{productoA\u00F1adido:"productoA\xF1adido"},decls:18,vars:22,consts:[[1,"card","tarjeta-producto","sombra-suave","borde-claro","rounded-3","overflow-hidden"],[1,"text-decoration-none","text-dark",3,"routerLink"],["class","card-img-top img-fluid",3,"src","alt","error",4,"ngIf"],["src","assets/img/imagen-no-disponible.webp","class","card-img-top img-fluid","alt","Imagen por defecto",4,"ngIf"],[1,"card-body","d-flex","flex-column"],[1,"card-title","mb-2","fw-bold"],[1,"card-text","text-muted","small","flex-grow-1"],[1,"fw-bold","mb-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-sm","btn-primario",3,"routerLink"],[1,"btn","btn-sm","btn-secundario",3,"click"],[1,"card-img-top","img-fluid",3,"error","src","alt"],["src","assets/img/imagen-no-disponible.webp","alt","Imagen por defecto",1,"card-img-top","img-fluid"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"a",1),g(2,Wt,1,2,"img",2)(3,Bt,1,0,"img",3),o(),n(4,"div",4)(5,"a",1)(6,"h5",5),l(7),o()(),n(8,"p",6),l(9),o(),n(10,"p",7),l(11),W(12,"currency"),o(),n(13,"div",8)(14,"a",9),l(15," Ver detalle "),o(),n(16,"button",10),v("click",function(c){return r.agregarAlCarrito(c)}),l(17," A\xF1adir al carrito "),o()()()()),e&2&&(s(),m("routerLink",T(14,We,r.producto.id)),s(),m("ngIf",!r.imagenFallida[r.producto.id]),s(),m("ngIf",r.imagenFallida[r.producto.id]),s(2),m("routerLink",T(16,We,r.producto.id)),s(2),b(r.producto.nombre),s(2),D(" ",r.producto.descripcion||"Descripci\xF3n no disponible"," "),s(2),b(q(12,8,T(18,Ut,r.producto.precio))),s(3),m("routerLink",T(20,We,r.producto.id)))},dependencies:[S,M,te,O,k],styles:[".tarjeta-producto[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;min-height:420px}.card-img-top[_ngcontent-%COMP%]{height:200px;object-fit:cover}.card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:1}.card-text[_ngcontent-%COMP%]{flex-grow:1;font-size:.9rem;font-family:Open Sans,sans-serif}.card-title[_ngcontent-%COMP%]{font-size:1.1rem;font-family:Montserrat,sans-serif}"]})};function zt(t,i){if(t&1&&(n(0,"option",12),l(1),o()),t&2){let e=i.$implicit;m("value",e),s(),b(e)}}function Ht(t,i){if(t&1&&(n(0,"option",12),l(1),o()),t&2){let e=i.$implicit;m("value",e),s(),b(e)}}function qt(t,i){if(t&1){let e=x();n(0,"div",15)(1,"app-tarjeta-producto",16),v("productoA\xF1adido",function(){u(e);let a=d(2);return f(a.mostrarBannerDesdeTarjeta())}),o()()}if(t&2){let e=i.$implicit;s(),m("producto",e)}}function Gt(t,i){if(t&1&&(n(0,"div")(1,"div",13),g(2,qt,2,1,"div",14),o()()),t&2){let e=d();s(2),m("ngForOf",e.componentes)}}function $t(t,i){t&1&&(n(0,"div",17),l(1," No hay componentes disponibles. "),o())}function Jt(t,i){if(t&1&&(n(0,"div",18),l(1),o()),t&2){let e=d();s(),D(" ",e.error," ")}}var Ve=class t{componentesService=de(_e);route=de(nt);app=de(ge);componentes=[];componentesOriginales=[];error="";filtroTipo="";filtroMarca="";tiposDisponibles=[];marcasDisponibles=[];ngOnInit(){this.route.queryParams.subscribe(i=>{this.filtroTipo=i.tipo||"",this.filtroMarca=i.marca||""}),this.componentesService.obtenerComponentes().subscribe({next:i=>{this.componentesOriginales=i,this.tiposDisponibles=[...new Set(i.map(e=>e.tipo).filter(Boolean))],this.marcasDisponibles=[...new Set(i.map(e=>e.marca).filter(Boolean))],this.aplicarFiltros()},error:i=>{console.error("\u274C Error al cargar componentes:",i),this.error="No se pudieron cargar los componentes."}})}aplicarFiltros(){this.componentes=this.componentesOriginales.filter(i=>{let e=this.filtroTipo?i.tipo===this.filtroTipo:!0,r=this.filtroMarca?i.marca===this.filtroMarca:!0;return e&&r})}mostrarBannerDesdeTarjeta(){this.app.mostrarBannerCarrito()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=h({type:t,selectors:[["app-componentes"]],decls:22,vars:7,consts:[["noComponentes",""],[1,"container","py-4"],[1,"mb-4","texto-grande","fw-bold"],[1,"row","g-3","mb-4","sombra-suave","p-3","borde-claro","rounded-3"],[1,"col-md-6"],["for","filtroTipo",1,"form-label"],[1,"form-select","input-estilizado",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","filtroMarca",1,"form-label"],[4,"ngIf","ngIfElse"],["class","alert alert-danger mt-3",4,"ngIf"],[3,"value"],[1,"row","row-cols-1","row-cols-sm-2","row-cols-md-3","g-4"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[3,"productoA\xF1adido","producto"],[1,"alert","alert-info","text-center","mt-4"],[1,"alert","alert-danger","mt-3"]],template:function(e,r){if(e&1){let a=x();n(0,"div",1)(1,"h2",2),l(2,"Lista de Componentes"),o(),n(3,"div",3)(4,"div",4)(5,"label",5),l(6,"Filtrar por tipo"),o(),n(7,"select",6),E("ngModelChange",function(_){return u(a),w(r.filtroTipo,_)||(r.filtroTipo=_),f(_)}),v("change",function(){return u(a),f(r.aplicarFiltros())}),n(8,"option",7),l(9,"Todos"),o(),g(10,zt,2,2,"option",8),o()(),n(11,"div",4)(12,"label",9),l(13,"Filtrar por marca"),o(),n(14,"select",6),E("ngModelChange",function(_){return u(a),w(r.filtroMarca,_)||(r.filtroMarca=_),f(_)}),v("change",function(){return u(a),f(r.aplicarFiltros())}),n(15,"option",7),l(16,"Todas"),o(),g(17,Ht,2,2,"option",8),o()()(),g(18,Gt,3,1,"div",10)(19,$t,2,0,"ng-template",null,0,ee)(21,Jt,2,1,"div",11),o()}if(e&2){let a=P(20);s(7),y("ngModel",r.filtroTipo),s(3),m("ngForOf",r.tiposDisponibles),s(4),y("ngModel",r.filtroMarca),s(3),m("ngForOf",r.marcasDisponibles),s(),m("ngIf",r.componentes.length>0)("ngIfElse",a),s(3),m("ngIf",r.error)}},dependencies:[S,A,M,O,re,st,mt,lt,L,oe,Fe],styles:["h2[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif}.input-estilizado[_ngcontent-%COMP%]{border:1px solid #E0E0E0;font-family:Open Sans,sans-serif}"]})};function Xt(t,i){if(t&1&&(n(0,"div",22)(1,"div",23),l(2),o()()),t&2){let e=d(2);s(2),b(e.mensaje)}}function Zt(t,i){if(t&1&&(n(0,"div",22)(1,"div",24),l(2),o()()),t&2){let e=d(2);s(2),b(e.error)}}function Kt(t,i){if(t&1){let e=x();n(0,"div",2)(1,"h2",3),l(2,"Mis datos"),o(),n(3,"form",4),v("ngSubmit",function(){u(e);let a=d();return f(a.guardarCambios())}),n(4,"div",5)(5,"label",6),l(6,"Nombre"),o(),p(7,"input",7),o(),n(8,"div",5)(9,"label",8),l(10,"Primer Apellido"),o(),p(11,"input",9),o(),n(12,"div",5)(13,"label",10),l(14,"Segundo Apellido"),o(),p(15,"input",11),o(),n(16,"div",5)(17,"label",12),l(18,"Correo electr\xF3nico"),o(),p(19,"input",13),o(),n(20,"div",5)(21,"label",14),l(22,"DNI"),o(),p(23,"input",15),o(),n(24,"div",5)(25,"label",16),l(26,"Tel\xE9fono"),o(),p(27,"input",17),o(),g(28,Xt,3,1,"div",18)(29,Zt,3,1,"div",18),n(30,"div",19)(31,"button",20),p(32,"i",21),l(33," Guardar cambios "),o()()()()}if(t&2){let e=d();s(3),m("formGroup",e.formUsuario),s(25),m("ngIf",e.mensaje),s(),m("ngIf",e.error),s(2),m("disabled",e.formUsuario.invalid)}}function Qt(t,i){t&1&&(n(0,"div")(1,"p",25),l(2,"Cargando datos del usuario..."),o()())}var ke=class t{constructor(i,e,r){this.usuarioService=i;this.fb=e;this.http=r}formUsuario;mensaje="";error="";ngOnInit(){this.usuarioService.getDatosUsuario().subscribe({next:i=>{this.formUsuario=this.fb.group({nombre:[i.nombre,I.required],apellido1:[i.apellido1,I.required],apellido2:[i.apellido2],email:[{value:i.email,disabled:!0}],dni:[i.dni,I.required],telefono:[i.telefono,[I.required,I.pattern(/^\d{9}$/)]]})},error:i=>{console.error("\u274C Error al obtener datos de usuario",i),this.error="No se pudieron cargar los datos del usuario."}})}guardarCambios(){if(this.formUsuario.invalid)return;let i=this.formUsuario.getRawValue();this.usuarioService.actualizarDatosUsuario(i).subscribe({next:()=>{this.mensaje="\u2705 Datos actualizados correctamente.",this.error=""},error:e=>{console.error("\u274C Error al actualizar datos:",e),this.mensaje="",this.error="\u274C Error al actualizar los datos."}})}static \u0275fac=function(e){return new(e||t)(C(we),C(Se),C(ie))};static \u0275cmp=h({type:t,selectors:[["app-mis-datos"]],decls:2,vars:2,consts:[["class","container mt-4",4,"ngIf"],[4,"ngIf"],[1,"container","mt-4"],[1,"mb-4","texto-grande","fw-bold"],[1,"row","g-3",3,"ngSubmit","formGroup"],[1,"col-md-6"],["for","nombre",1,"form-label"],["id","nombre","type","text","formControlName","nombre","required","",1,"form-control","input-estilizado"],["for","apellido1",1,"form-label"],["id","apellido1","type","text","formControlName","apellido1","required","",1,"form-control","input-estilizado"],["for","apellido2",1,"form-label"],["id","apellido2","type","text","formControlName","apellido2",1,"form-control","input-estilizado"],["for","email",1,"form-label"],["type","email","formControlName","email",1,"form-control","input-estilizado"],["for","dni",1,"form-label"],["id","dni","type","text","formControlName","dni","required","",1,"form-control","input-estilizado"],["for","telefono",1,"form-label"],["id","telefono","type","text","formControlName","telefono","required","",1,"form-control","input-estilizado"],["class","col-12",4,"ngIf"],[1,"col-12","text-end"],["type","submit",1,"btn","btn-secundario",3,"disabled"],[1,"bi","bi-save","me-1"],[1,"col-12"],[1,"alert","alert-success"],[1,"alert","alert-danger"],[1,"text-muted"]],template:function(e,r){e&1&&g(0,Kt,34,4,"div",0)(1,Qt,3,0,"div",1),e&2&&(m("ngIf",r.formUsuario),s(),m("ngIf",!r.formUsuario))},dependencies:[S,M,ye,X,J,L,Y,ne,be,Ce],encapsulation:2})};var ei=()=>["alias","calle","numero","piso","ciudad","provincia","codigoPostal","pais"],ti=t=>({"is-invalid":t});function ii(t,i){if(t&1&&(n(0,"span"),l(1),o()),t&2){let e=d().$implicit;s(),D(", piso ",e.piso,"")}}function oi(t,i){if(t&1){let e=x();n(0,"div",10)(1,"div",11)(2,"div",12)(3,"h5",13),l(4),o(),n(5,"p",14),l(6),g(7,ii,2,1,"span",15),p(8,"br"),l(9),p(10,"br"),l(11),o(),n(12,"div",16)(13,"button",17),v("click",function(){let a=u(e).$implicit,c=d(2);return f(c.editarDireccion(a))}),p(14,"i",18),l(15," Editar "),o(),n(16,"button",19),v("click",function(){let a=u(e).$implicit,c=d(2);return f(c.eliminarDireccion(a.id))}),p(17,"i",20),l(18," Eliminar "),o()()()()()}if(t&2){let e=i.$implicit;s(4),b(e.alias),s(2),Ye(" ",e.calle,", ",e.numero," "),s(),m("ngIf",e.piso),s(2),Xe(" ",e.codigoPostal," ",e.ciudad," (",e.provincia,")"),s(2),D(" ",e.pais," ")}}function ni(t,i){if(t&1&&(n(0,"div")(1,"div",8),g(2,oi,19,8,"div",9),o()()),t&2){let e=d();s(2),m("ngForOf",e.direcciones)}}function ri(t,i){if(t&1){let e=x();n(0,"button",5),v("click",function(){u(e);let a=d();return f(a.iniciarNueva())}),p(1,"i",21),l(2," A\xF1adir direcci\xF3n "),o()}}function ai(t,i){t&1&&(n(0,"div"),l(1,"Este campo es obligatorio."),o())}function li(t,i){t&1&&(n(0,"div"),l(1,"Debe tener al menos 3 caracteres."),o())}function si(t,i){t&1&&(n(0,"div"),l(1,"Solo se permiten n\xFAmeros. "),o())}function mi(t,i){t&1&&(n(0,"div"),l(1,"Debe tener 5 d\xEDgitos. "),o())}function ci(t,i){if(t&1&&(n(0,"div",31),g(1,ai,2,0,"div",15)(2,li,2,0,"div",15)(3,si,2,0,"div",15)(4,mi,2,0,"div",15),o()),t&2){let e,r,a,c,_=d().$implicit,R=d(2);s(),m("ngIf",(e=R.formDireccion.get(_))==null||e.errors==null?null:e.errors.required),s(),m("ngIf",(r=R.formDireccion.get(_))==null||r.errors==null?null:r.errors.minlength),s(),m("ngIf",_==="numero"&&((a=R.formDireccion.get(_))==null||a.errors==null?null:a.errors.pattern)),s(),m("ngIf",_==="codigoPostal"&&((c=R.formDireccion.get(_))==null||c.errors==null?null:c.errors.pattern))}}function di(t,i){if(t&1&&(n(0,"div",27)(1,"label",28),l(2),o(),p(3,"input",29),g(4,ci,5,4,"div",30),o()),t&2){let e,r,a=i.$implicit,c=d(2);s(),m("for",a),s(),D("",a,":"),s(),m("formControlName",a)("id",a)("ngClass",T(8,ti,((e=c.formDireccion.get(a))==null?null:e.invalid)&&((e=c.formDireccion.get(a))==null?null:e.touched))),qe("inputmode",a==="numero"||a==="codigoPostal"?"numeric":null)("pattern",a==="numero"?"\\d+":a==="codigoPostal"?"\\d{5}":null),s(),m("ngIf",((r=c.formDireccion.get(a))==null?null:r.invalid)&&((r=c.formDireccion.get(a))==null?null:r.touched))}}function pi(t,i){if(t&1){let e=x();n(0,"form",22),v("ngSubmit",function(){u(e);let a=d();return f(a.onSubmit())}),n(1,"div",23),g(2,di,5,10,"div",24),o(),n(3,"div",4)(4,"button",25),p(5,"i",26),l(6),o()()()}if(t&2){let e=d();m("formGroup",e.formDireccion),s(2),m("ngForOf",Ze(4,ei)),s(2),m("disabled",e.formDireccion.invalid),s(2),D(" ",e.modoEdicion?"Actualizar":"Guardar"," ")}}var Oe=class t{constructor(i,e){this.usuarioService=i;this.fb=e;this.formDireccion=this.fb.group({alias:["",[I.required,I.minLength(3)]],calle:["",[I.required,I.minLength(3)]],numero:["",[I.required,I.pattern(/^\d+$/)]],piso:[""],ciudad:["",I.required],provincia:["",I.required],codigoPostal:["",[I.required,I.pattern(/^\d{5}$/)]],pais:["",I.required]})}direcciones=[];formDireccion;mostrarFormulario=!1;modoEdicion=!1;direccionEditandoId=null;ngOnInit(){this.cargarDirecciones()}cargarDirecciones(){this.usuarioService.getDirecciones().subscribe({next:i=>this.direcciones=i,error:i=>console.error("\u274C Error al obtener direcciones",i)})}iniciarNueva(){this.mostrarFormulario=!0,this.modoEdicion=!1,this.direccionEditandoId=null,this.formDireccion.reset()}editarDireccion(i){this.mostrarFormulario=!0,this.modoEdicion=!0,this.direccionEditandoId=i.id,this.formDireccion.patchValue(i)}eliminarDireccion(i){confirm("\xBFSeguro que deseas eliminar esta direcci\xF3n?")&&this.usuarioService.eliminarDireccion(i).subscribe({next:()=>this.cargarDirecciones(),error:e=>console.error("\u274C Error al eliminar direcci\xF3n",e)})}onSubmit(){if(this.formDireccion.invalid)return;let i=this.formDireccion.value;this.modoEdicion&&this.direccionEditandoId!==null?this.usuarioService.editarDireccion(this.direccionEditandoId,i).subscribe({next:()=>{this.cargarDirecciones(),this.mostrarFormulario=!1},error:e=>console.error("\u274C Error al actualizar direcci\xF3n",e)}):this.usuarioService.crearDireccion(i).subscribe({next:()=>{this.cargarDirecciones(),this.formDireccion.reset(),this.mostrarFormulario=!1},error:e=>console.error("\u274C Error al crear direcci\xF3n",e)})}static \u0275fac=function(e){return new(e||t)(C(we),C(Se))};static \u0275cmp=h({type:t,selectors:[["app-mis-direcciones"]],decls:11,vars:3,consts:[["sinDirecciones",""],[1,"container","mt-4"],[1,"mb-4","texto-grande","fw-bold"],[4,"ngIf","ngIfElse"],[1,"mt-4"],[1,"btn","btn-primario","d-flex","align-items-center","gap-2",3,"click"],[1,"bi-file-earmark-plus"],["class","mt-4",3,"formGroup","ngSubmit",4,"ngIf"],[1,"row","row-cols-1","row-cols-md-2","g-4"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[1,"card","h-100","sombra-suave","borde-claro"],[1,"card-body"],[1,"card-title","fw-bold"],[1,"card-text","small"],[4,"ngIf"],[1,"d-flex","justify-content-end","gap-2"],[1,"btn","btn-secundario","btn-sm","me-2",3,"click"],[1,"bi","bi-pencil"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"bi","bi-trash"],[1,"bi","bi-plus"],[1,"mt-4",3,"ngSubmit","formGroup"],[1,"row","g-3"],["class","col-md-4",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-secundario",3,"disabled"],[1,"bi","bi-save","me-1"],[1,"col-md-4"],[1,"form-label","text-capitalize",3,"for"],["type","text",1,"form-control","input-estilizado",3,"formControlName","id","ngClass"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(e,r){if(e&1){let a=x();n(0,"div",1)(1,"h2",2),l(2,"Mis direcciones"),o(),g(3,ni,3,1,"div",3)(4,ri,3,0,"ng-template",null,0,ee),n(6,"div",4)(7,"button",5),v("click",function(){return u(a),f(r.iniciarNueva())}),p(8,"i",6),l(9," A\xF1adir direcci\xF3n "),o()(),g(10,pi,7,5,"form",7),o()}if(e&2){let a=P(5);s(3),m("ngIf",r.direcciones.length>0)("ngIfElse",a),s(7),m("ngIf",r.mostrarFormulario)}},dependencies:[S,pe,A,M,ye,X,J,L,Y,be,Ce],encapsulation:2})};var ui=t=>[t,"EUR","symbol","1.2-2","es-ES"],fi=t=>["/pedido",t];function gi(t,i){if(t&1&&p(0,"i",9),t&2){let e=d(2);m("ngClass",e.sortAsc?"bi-caret-up-fill":"bi-caret-down-fill")}}function _i(t,i){if(t&1&&p(0,"i",9),t&2){let e=d(2);m("ngClass",e.sortAsc?"bi-caret-up-fill":"bi-caret-down-fill")}}function vi(t,i){if(t&1&&p(0,"i",9),t&2){let e=d(2);m("ngClass",e.sortAsc?"bi-caret-up-fill":"bi-caret-down-fill")}}function bi(t,i){if(t&1&&p(0,"i",9),t&2){let e=d(2);m("ngClass",e.sortAsc?"bi-caret-up-fill":"bi-caret-down-fill")}}function Ci(t,i){if(t&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),W(5,"date"),o(),n(6,"td"),l(7),o(),n(8,"td"),l(9),W(10,"currency"),o(),n(11,"td"),l(12),o(),n(13,"td")(14,"a",10),p(15,"i",11),l(16," Ver detalle "),o()()()),t&2){let e=i.$implicit;s(2),b(e.id),s(2),b(Ke(5,6,e.fecha,"short")),s(3),b(e.estado),s(2),b(q(10,9,T(15,ui,e.total))),s(3),b(e.direccionAlias),s(2),m("routerLink",T(17,fi,e.id))}}function xi(t,i){if(t&1){let e=x();n(0,"table",4)(1,"thead",5)(2,"tr")(3,"th",6),v("click",function(){u(e);let a=d();return f(a.ordenarPor("id"))}),l(4," ID "),g(5,gi,1,1,"i",7),o(),n(6,"th",6),v("click",function(){u(e);let a=d();return f(a.ordenarPor("fecha"))}),l(7," Fecha "),g(8,_i,1,1,"i",7),o(),n(9,"th",6),v("click",function(){u(e);let a=d();return f(a.ordenarPor("estado"))}),l(10," Estado "),g(11,vi,1,1,"i",7),o(),n(12,"th",6),v("click",function(){u(e);let a=d();return f(a.ordenarPor("total"))}),l(13," Total "),g(14,bi,1,1,"i",7),o(),n(15,"th"),l(16,"Direcci\xF3n"),o(),n(17,"th"),l(18,"Acciones"),o()()(),n(19,"tbody"),g(20,Ci,17,19,"tr",8),o()()}if(t&2){let e=d();s(5),m("ngIf",e.sortCampo==="id"),s(3),m("ngIf",e.sortCampo==="fecha"),s(3),m("ngIf",e.sortCampo==="estado"),s(3),m("ngIf",e.sortCampo==="total"),s(6),m("ngForOf",e.pedidos)}}function hi(t,i){t&1&&(n(0,"div",12),l(1,"No tienes pedidos realizados."),o())}var Re=class t{constructor(i){this.pedidoService=i}pedidos=[];ngOnInit(){this.pedidoService.getPedidosDelUsuario().subscribe({next:i=>{this.pedidos=i,console.log("\u2705 Pedidos del usuario:",i)},error:i=>{console.error("\u274C Error al obtener pedidos",i)}})}sortCampo="";sortAsc=!0;ordenarPor(i){this.sortCampo===i?this.sortAsc=!this.sortAsc:(this.sortCampo=i,this.sortAsc=!0),this.pedidos.sort((e,r)=>{let a=e[i],c=r[i];return a<c?this.sortAsc?-1:1:a>c?this.sortAsc?1:-1:0})}getIconoOrden(i){return this.sortCampo!==i?"bi bi-arrow-down-up":this.sortAsc?"bi bi-arrow-down":"bi bi-arrow-up"}static \u0275fac=function(e){return new(e||t)(C(dt))};static \u0275cmp=h({type:t,selectors:[["app-mis-pedidos"]],decls:6,vars:2,consts:[["sinPedidos",""],[1,"container","mt-4"],[1,"texto-grande","fw-bold","mb-3"],["class","table table-bordered table-hover sombra-suave borde-claro",4,"ngIf","ngIfElse"],[1,"table","table-bordered","table-hover","sombra-suave","borde-claro"],[1,"table-light"],[1,"sortable",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"bi",3,"ngClass"],[1,"btn","btn-sm","btn-primario",3,"routerLink"],[1,"bi","bi-receipt","me-1"],[1,"alert","alert-info","mt-3"]],template:function(e,r){if(e&1&&(n(0,"div",1)(1,"h2",2),l(2,"Mis pedidos"),o(),g(3,xi,21,5,"table",3)(4,hi,2,0,"ng-template",null,0,ee),o()),e&2){let a=P(5);s(3),m("ngIf",r.pedidos.length>0)("ngIfElse",a)}},dependencies:[S,pe,A,M,te,Qe,O,k],encapsulation:2})};var Ae=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=h({type:t,selectors:[["app-area-personal"]],decls:16,vars:0,consts:[[1,"container","mt-4"],[1,"row"],[1,"col-md-3","mb-3"],[1,"list-group","sombra-suave","borde-claro","rounded-3"],["routerLink","datos","routerLinkActive","active",1,"list-group-item","list-group-item-action","d-flex","align-items-center","gap-2"],[1,"bi","bi-person-circle"],["routerLink","direcciones","routerLinkActive","active",1,"list-group-item","list-group-item-action","d-flex","align-items-center","gap-2"],[1,"bi","bi-house-door"],["routerLink","pedidos","routerLinkActive","active",1,"list-group-item","list-group-item-action","d-flex","align-items-center","gap-2"],[1,"bi","bi-box-seam"],[1,"col-md-9"],[1,"bg-white","rounded-3","sombra-suave","p-3"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"a",4),p(5,"i",5),l(6," Mis datos "),o(),n(7,"a",6),p(8,"i",7),l(9," Mis direcciones "),o(),n(10,"a",8),p(11,"i",9),l(12," Mis pedidos "),o()()(),n(13,"div",10)(14,"div",11),p(15,"router-outlet"),o()()()())},dependencies:[S,O,ue,k,rt],styles:[".list-group-item[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;font-size:1rem;color:#333;border:none;padding:.75rem 1rem;transition:background-color .2s ease}.list-group-item[_ngcontent-%COMP%]:hover{background-color:#f7f8fa}.list-group-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#1e2a38}.list-group-item.active[_ngcontent-%COMP%]{background-color:#ff6b00;color:#fff}.list-group-item.active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff}"]})};var Q=class t{constructor(i){this.router=i}canActivate(){let i=localStorage.getItem("token");return console.log("\u{1F6E1}\uFE0F Comprobando token en AuthGuard:",i),i?(console.log("\u2705 Token encontrado. Acceso permitido."),!0):(console.log("\u274C Token no encontrado. Redirigiendo a login."),this.router.navigate(["/login"]),!1)}static \u0275fac=function(e){return new(e||t)(j(F))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};var Be=t=>[t,"EUR","symbol","1.2-2","es-ES"];function Si(t,i){t&1&&(n(0,"div",6),p(1,"i",7),l(2," Debes iniciar sesi\xF3n para formalizar el pedido. "),o())}function yi(t,i){t&1&&(n(0,"div",8),l(1," Tu carrito est\xE1 vac\xEDo. "),n(2,"div",9)(3,"a",10),l(4,"Volver a la tienda"),o()()())}function wi(t,i){if(t&1){let e=x();n(0,"tr")(1,"td",20),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),W(7,"currency"),o(),n(8,"td"),l(9),W(10,"currency"),o(),n(11,"td")(12,"button",21),v("click",function(){let a=u(e).$implicit,c=d(2);return f(c.eliminarProducto(a.id))}),p(13,"i",22),l(14," Eliminar "),o()()()}if(t&2){let e=i.$implicit;s(2),b(e.nombre),s(2),b(e.cantidad),s(2),b(q(7,4,T(16,Be,e.precio))),s(3),b(q(10,10,T(18,Be,e.precio*e.cantidad)))}}function Ei(t,i){if(t&1){let e=x();n(0,"div",11)(1,"table",12)(2,"thead",13)(3,"tr")(4,"th"),l(5,"Producto"),o(),n(6,"th"),l(7,"Cantidad"),o(),n(8,"th"),l(9,"Precio"),o(),n(10,"th"),l(11,"Total"),o(),p(12,"th"),o()(),n(13,"tbody"),g(14,wi,15,20,"tr",14),o()(),n(15,"div",15)(16,"h4"),l(17),W(18,"currency"),o(),n(19,"div")(20,"button",16),v("click",function(){u(e);let a=d();return f(a.vaciarCarrito())}),p(21,"i",17),l(22," Vaciar carrito "),o(),n(23,"button",18),v("click",function(){u(e);let a=d();return f(a.irASeleccionDireccion())}),p(24,"i",19),l(25," Finalizar compra "),o()()()()}if(t&2){let e=d();s(14),m("ngForOf",e.carrito),s(3),D("Total: ",q(18,2,T(8,Be,e.obtenerTotal())),"")}}var Le=class t{constructor(i,e){this.carritoService=i;this.router=e}carrito=[];mostrarAvisoLogin=!1;ngOnInit(){this.cargarCarrito()}cargarCarrito(){this.carrito=this.carritoService.obtenerCarrito()}eliminarProducto(i){this.carritoService.eliminarProducto(i),this.cargarCarrito()}vaciarCarrito(){this.carritoService.vaciarCarrito(),this.cargarCarrito()}obtenerTotal(){return this.carrito.reduce((i,e)=>i+e.precio*e.cantidad,0)}irASeleccionDireccion(){localStorage.getItem("token")?this.router.navigate(["/seleccionar-direccion"]):(this.mostrarAvisoLogin=!0,setTimeout(()=>{this.mostrarAvisoLogin=!1},1500))}static \u0275fac=function(e){return new(e||t)(C(G),C(F))};static \u0275cmp=h({type:t,selectors:[["app-carrito"]],decls:7,vars:3,consts:[[1,"container","py-4"],[1,"texto-grande","fw-bold","mb-4"],[1,"bi","bi-cart","me-2"],["class","alerta-banner alerta-login mb-4",4,"ngIf"],["class","alert alert-info sombra-suave",4,"ngIf"],["class","table-responsive sombra-suave borde-claro p-3 rounded-3 bg-white",4,"ngIf"],[1,"alerta-banner","alerta-login","mb-4"],[1,"bi","bi-exclamation-triangle-fill","me-2"],[1,"alert","alert-info","sombra-suave"],[1,"mt-3"],["routerLink","/",1,"btn","btn-primario"],[1,"table-responsive","sombra-suave","borde-claro","p-3","rounded-3","bg-white"],[1,"table","table-hover","align-middle"],[1,"table-light"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","mt-4"],[1,"btn","btn-outline-danger","me-2",3,"click"],[1,"bi","bi-x-circle"],[1,"btn","btn-primario",3,"click"],[1,"bi","bi-check2-circle"],[1,"fw-semibold"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"bi","bi-trash"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h2",1),p(2,"i",2),l(3," Mi carrito "),o(),g(4,Si,3,0,"div",3)(5,yi,5,0,"div",4)(6,Ei,26,10,"div",5),o()),e&2&&(s(4),m("ngIf",r.mostrarAvisoLogin),s(),m("ngIf",r.carrito.length===0),s(),m("ngIf",r.carrito.length>0))},dependencies:[S,A,M,te,O,k],styles:[".alerta-banner[_ngcontent-%COMP%]{background-color:#ff6b001a;color:#ff6b00;padding:1rem;border:1px solid #FF6B00;border-radius:.5rem;font-weight:600;display:flex;align-items:center;margin-bottom:1rem;animation:_ngcontent-%COMP%_slideIn .3s ease}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;border-radius:.5rem}@media (max-width: 576px){.table[_ngcontent-%COMP%]{font-size:.875rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap;padding:.5rem}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:1rem;border:1px solid #E0E0E0;border-radius:.5rem;padding:1rem;background-color:#fff}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none!important}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);font-weight:700;display:block;margin-bottom:.25rem;color:#333}}@media (max-width: 768px){.total-carrito[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start!important;gap:1rem}.total-carrito[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:.5rem}.total-carrito[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin-top:.5rem}}"]})};function Ii(t,i){t&1&&($e(0),n(1,"a",11),p(2,"i",12),l(3," Ventas por empleados "),o(),n(4,"div",13)(5,"h5",14),l(6,"Gesti\xF3n de componentes"),o()(),n(7,"a",15),p(8,"i",16),l(9," Listar componentes "),o(),n(10,"a",17),p(11,"i",18),l(12," Crear nuevo componente "),o(),n(13,"a",19),p(14,"i",20),l(15," Gesti\xF3n de usuarios "),o(),Je())}var Ne=class t{constructor(i,e){this.router=i;this.roleService=e}email="";rol="";ngOnInit(){let i=localStorage.getItem("token");if(i)try{let e=Me(i);this.email=e.sub,this.rol=e.rol,console.log("\u{1F4CA} Dashboard cargado para:",this.email,"con rol:",this.rol)}catch{console.error("\u274C Error al decodificar token")}}logout(){localStorage.clear(),this.router.navigate(["/login"])}static \u0275fac=function(e){return new(e||t)(C(F),C(fe))};static \u0275cmp=h({type:t,selectors:[["app-dashboard"]],decls:21,vars:3,consts:[[1,"container","mt-5","max-ancho"],[1,"text-center","mb-4"],[1,"fw-bold","texto-grande"],[1,"text-muted"],[1,"d-flex","flex-column","align-items-center","gap-3"],["routerLink","/crear-pedido",1,"btn","btn-primario","w-75","d-flex","align-items-center","justify-content-center","gap-2"],[1,"bi","bi-cart-plus-fill"],["routerLink","/dashboard/pedidos-clientes",1,"btn","btn-primario","w-75","d-flex","align-items-center","justify-content-center","gap-2"],[1,"bi","bi-box-seam"],[4,"ngIf"],[1,"my-4"],["routerLink","/admin/ventas",1,"btn","btn-secundario","w-75","d-flex","align-items-center","justify-content-center","gap-2"],[1,"bi","bi-bar-chart-line-fill"],[1,"text-center","mt-4","mb-1"],[1,"fw-bold","text-uppercase","text-muted"],["routerLink","/dashboard/componentes",1,"btn","btn-secundario","w-75","d-flex","align-items-center","justify-content-center","gap-2"],[1,"bi","bi-list-ul"],["routerLink","/dashboard/componentes/nuevo",1,"btn","btn-secundario","w-75","d-flex","align-items-center","justify-content-center","gap-2"],[1,"bi","bi-plus-circle-fill"],["routerLink","/admin/usuarios",1,"btn","btn-secundario","w-75","d-flex","align-items-center","justify-content-center","gap-2"],[1,"bi","bi-people-fill"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),l(3,"\xC1rea privada"),o(),n(4,"p",3),l(5,"Bienvenido, "),n(6,"strong"),l(7),o(),p(8,"br"),l(9),o(),p(10,"hr"),o(),n(11,"div",4)(12,"a",5),p(13,"i",6),l(14," Crear pedido para cliente "),o(),n(15,"a",7),p(16,"i",8),l(17," Ver pedidos de clientes "),o(),g(18,Ii,16,0,"ng-container",9),o(),p(19,"hr",10)(20,"router-outlet"),o()),e&2&&(s(7),b(r.email),s(2),D(" Rol: ",r.rol,""),s(9),m("ngIf",r.roleService.isAdmin()))},dependencies:[S,M,O,ue,k],encapsulation:2})};var Z=class t{constructor(i,e){this.roleService=i;this.router=e}canActivate(i){if(!this.roleService.isAuthenticated())return this.router.parseUrl("/login");let e=this.roleService.getRol();return i.data.roles.includes(e)?!0:this.router.parseUrl("/")}static \u0275fac=function(e){return new(e||t)(j(fe),j(F))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};var ft=[{path:"",component:Ee},{path:"login",component:De},{path:"registro",component:Te},{path:"componentes",component:Ve},{path:"componentes/:id",loadComponent:()=>import("./chunk-4G56BYRV.js").then(t=>t.DetalleComponenteComponent)},{path:"carrito",component:Le},{path:"dashboard",component:Ne,canActivate:[Z],data:{roles:["ROLE_ADMIN","ROLE_EMPLEADO"]}},{path:"crear-pedido",loadComponent:()=>import("./chunk-4KZE5E5F.js").then(t=>t.CrearPedidoComponent),canActivate:[Z],data:{roles:["ROLE_ADMIN","ROLE_EMPLEADO"]}},{path:"admin/usuarios",loadComponent:()=>import("./chunk-7E7IHKDE.js").then(t=>t.UsuariosComponent),canActivate:[Q]},{path:"area-personal",component:Ae,canActivate:[Q],children:[{path:"",redirectTo:"datos",pathMatch:"full"},{path:"datos",component:ke},{path:"direcciones",component:Oe},{path:"pedidos",component:Re}]},{path:"seleccionar-direccion",loadComponent:()=>import("./chunk-OHGJVULX.js").then(t=>t.SeleccionarDireccionComponent)},{path:"finalizar-compra",loadComponent:()=>import("./chunk-QK7HBRBO.js").then(t=>t.FinalizarCompraComponent)},{path:"pedido/:id",loadComponent:()=>import("./chunk-2FAPFM6H.js").then(t=>t.DetallePedidoComponent),canActivate:[Q]},{path:"dashboard/detalle-venta/:id",loadComponent:()=>import("./chunk-2RNSVZHR.js").then(t=>t.DetalleVentaComponent),canActivate:[Q],data:{roles:["ADMIN","EMPLEADO"]}},{path:"admin/ventas",loadComponent:()=>import("./chunk-YRNLT5U3.js").then(t=>t.VentasEmpleadosComponent)},{path:"dashboard/componentes",loadComponent:()=>import("./chunk-W22PFTHZ.js").then(t=>t.GestionarComponentesComponent),canActivate:[Z],data:{roles:["ROLE_ADMIN"]}},{path:"dashboard/componentes/nuevo",loadComponent:()=>import("./chunk-WWNMTBC7.js").then(t=>t.FormularioComponenteComponent),canActivate:[Z],data:{roles:["ROLE_ADMIN"]}},{path:"dashboard/componentes/modificar/:id",loadComponent:()=>import("./chunk-ZCKZ3QXY.js").then(t=>t.ModificarComponenteComponent)},{path:"dashboard/pedidos-clientes",loadComponent:()=>import("./chunk-WUE7J6PE.js").then(t=>t.PedidosClientesComponent),canActivate:[Z],data:{roles:["ROLE_ADMIN","ROLE_EMPLEADO"]}},{path:"**",redirectTo:"",pathMatch:"full"}];var gt=(t,i)=>{let e=localStorage.getItem("token");if(e){let r=t.clone({setHeaders:{Authorization:`Bearer ${e}`}});return console.log("\u{1F517} Interceptor funcional: token a\xF1adido a",t.url),i(r)}return console.warn("\u26A0\uFE0F No hay token en localStorage. Solicitud sin autorizaci\xF3n:",t.url),i(t)};function Di(t){let i=t,e=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length,a=parseInt(t.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return i===1?1:a===0&&e!==0&&e%1e6===0&&r===0||!(a>=0&&a<=5)?4:5}var _t=["es",[["a.\xA0m.","p.\xA0m."],void 0,void 0],void 0,[["D","L","M","X","J","V","S"],["dom","lun","mar","mi\xE9","jue","vie","s\xE1b"],["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"],["DO","LU","MA","MI","JU","VI","SA"]],void 0,[["E","F","M","A","M","J","J","A","S","O","N","D"],["ene","feb","mar","abr","may","jun","jul","ago","sept","oct","nov","dic"],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]],void 0,[["a. C.","d. C."],void 0,["antes de Cristo","despu\xE9s de Cristo"]],1,[6,0],["d/M/yy","d MMM y","d 'de' MMMM 'de' y","EEEE, d 'de' MMMM 'de' y"],["H:mm","H:mm:ss","H:mm:ss z","H:mm:ss (zzzz)"],["{1}, {0}",void 0,void 0,void 0],[",",".",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0\xA0%","#,##0.00\xA0\xA4","#E0"],"EUR","\u20AC","euro",{AUD:[void 0,"$"],BRL:[void 0,"R$"],BYN:[void 0,"\u0440."],CAD:[void 0,"$"],CNY:[void 0,"\xA5"],EGP:[],ESP:["\u20A7"],GBP:[void 0,"\xA3"],HKD:[void 0,"$"],ILS:[void 0,"\u20AA"],INR:[void 0,"\u20B9"],JPY:[void 0,"\xA5"],KRW:[void 0,"\u20A9"],MXN:[void 0,"$"],NZD:[void 0,"$"],PHP:[void 0,"\u20B1"],RON:[void 0,"L"],THB:["\u0E3F"],TWD:[void 0,"NT$"],USD:["US$","$"],XAF:[],XCD:[void 0,"$"],XOF:[]},"ltr",Di];et(_t);tt(ge,{providers:[at(ft),it(ot([gt]))]});
