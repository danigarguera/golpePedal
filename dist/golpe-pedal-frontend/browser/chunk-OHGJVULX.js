import{a as U,c as B,d as L,e as j,f as k,g as R,o as H,t as G}from"./chunk-ND65VQ52.js";import{a as J}from"./chunk-E5SSPYM6.js";import{$ as u,B as f,C as T,Da as q,G as _,Ia as A,J as b,M as t,N as r,O as D,R as C,S as w,T as S,V as x,W as a,X as O,Y as y,Z as P,_ as I,aa as g,ba as v,ja as V,k as M,n as E,q as d,qa as W,r as m,ra as F,ua as N,ya as z,z as l}from"./chunk-YAXSTRSO.js";var h=class c{constructor(i){this.http=i}apiUrl=`${A.apiUrl}`;obtenerMisDirecciones(){return this.http.get(`${this.apiUrl}/direcciones`)}crearDireccion(i){return this.http.post(`${this.apiUrl}/direcciones`,i)}obtenerDireccionesPorUsuario(i){return this.http.get(`${this.apiUrl}/direcciones/usuario/${i}`)}crearDireccionComoEmpleado(i){return this.http.post(`${this.apiUrl}/direcciones/admin`,i)}static \u0275fac=function(o){return new(o||c)(E(z))};static \u0275prov=M({token:c,factory:c.\u0275fac,providedIn:"root"})};function Y(c,i){if(c&1&&(t(0,"span"),a(1),r()),c&2){let o=S().$implicit;l(),y(", piso ",o.piso,"")}}function Z(c,i){if(c&1){let o=C();t(0,"div",34)(1,"div",35)(2,"div",36)(3,"h5",37),a(4),r(),t(5,"p",38),a(6),_(7,Y,2,1,"span",39),D(8,"br"),a(9),D(10,"br"),a(11),r(),t(12,"button",40),w("click",function(){let s=d(o).$implicit,p=S(2);return m(p.seleccionarDireccion(s))}),D(13,"i",41),a(14," Usar esta direcci\xF3n "),r()()()()}if(c&2){let o=i.$implicit;l(4),O(o.alias),l(2),P(" ",o.calle,", ",o.numero," "),l(),b("ngIf",o.piso),l(2),I(" ",o.codigoPostal," ",o.ciudad," (",o.provincia,")"),l(2),y(" ",o.pais," ")}}function $(c,i){if(c&1&&(t(0,"div")(1,"div",32),_(2,Z,15,8,"div",33),r()()),c&2){let o=S();l(2),b("ngForOf",o.direcciones)}}function ee(c,i){c&1&&(t(0,"div",42),a(1," No tienes direcciones guardadas. A\xF1ade una nueva abajo. "),r())}var K=class c{constructor(i,o,n){this.direccionService=i;this.router=o;this.authService=n;console.log("\u{1F4CC} Constructor SeleccionarDireccionComponent")}direcciones=[];nuevaDireccion=this.inicializarDireccion();usuarioId=0;ngOnInit(){this.authService.getUsuarioActual().subscribe({next:i=>{this.usuarioId=i.id,this.cargarDirecciones()},error:()=>{alert("Para finalizar la compra, por favor inicia sesi\xF3n."),this.router.navigate(["/login"],{queryParams:{redirectTo:"/seleccionar-direccion"}})}})}cargarDirecciones(){this.direccionService.obtenerMisDirecciones().subscribe({next:i=>{console.log("\u2705 Direcciones cargadas:",i),this.direcciones=i},error:i=>{console.error("\u274C Error al cargar direcciones:",i),alert("No se pudieron cargar tus direcciones.")}})}seleccionarDireccion(i){console.log("\u{1F9ED} Navegando con direcci\xF3n:",i),this.router.navigate(["/finalizar-compra"],{state:{direccionSeleccionada:i}})}crearDireccion(){this.direccionService.crearDireccion(this.nuevaDireccion).subscribe({next:i=>{this.direcciones.push(i),this.nuevaDireccion=this.inicializarDireccion(),alert("Direcci\xF3n a\xF1adida correctamente")},error:i=>console.error("Error al crear direcci\xF3n:",i)})}inicializarDireccion(){return{alias:"",calle:"",numero:"",piso:"",ciudad:"",provincia:"",codigoPostal:"",pais:""}}static \u0275fac=function(o){return new(o||c)(f(h),f(q),f(J))};static \u0275cmp=T({type:c,selectors:[["app-seleccionar-direccion"]],decls:50,vars:10,consts:[["sinDirecciones",""],["direccionForm","ngForm"],[1,"container","py-4"],[1,"texto-grande","fw-bold","mb-4"],[1,"bi","bi-geo-alt-fill","me-2"],[4,"ngIf","ngIfElse"],[1,"mt-5"],[1,"mb-3"],[1,"bi","bi-plus-circle-fill","me-2"],[1,"sombra-suave","p-4","rounded-3","bg-white","borde-claro",3,"ngSubmit"],[1,"row","g-3"],[1,"col-md-6"],["for","alias",1,"form-label"],["type","text","id","alias","name","alias","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["for","calle",1,"form-label"],["type","text","id","calle","name","calle","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],[1,"col-md-3"],["for","numero",1,"form-label"],["type","text","id","numero","name","numero","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["for","piso",1,"form-label"],["type","text","id","piso","name","piso",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["for","ciudad",1,"form-label"],["type","text","id","ciudad","name","ciudad","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["for","provincia",1,"form-label"],["type","text","id","provincia","name","provincia","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["for","codigoPostal",1,"form-label"],["type","text","id","codigoPostal","name","codigoPostal","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],["for","pais",1,"form-label"],["type","text","id","pais","name","pais","required","",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],[1,"col-12","text-end","mt-3"],["type","submit",1,"btn","btn-secundario"],[1,"bi","bi-save","me-1"],[1,"row","row-cols-1","row-cols-md-2","g-4","mt-3"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[1,"card","sombra-suave","borde-claro","h-100"],[1,"card-body"],[1,"card-title","fw-semibold"],[1,"card-text","text-muted","mb-3"],[4,"ngIf"],[1,"btn","btn-primario","w-100",3,"click"],[1,"bi","bi-check-circle-fill","me-1"],[1,"alert","alert-info","sombra-suave","mt-4"]],template:function(o,n){if(o&1){let s=C();t(0,"div",2)(1,"h2",3),D(2,"i",4),a(3," Selecciona una direcci\xF3n para el env\xEDo "),r(),_(4,$,3,1,"div",5)(5,ee,2,0,"ng-template",null,0,V),t(7,"div",6)(8,"h4",7),D(9,"i",8),a(10,"A\xF1adir nueva direcci\xF3n"),r(),t(11,"form",9,1),w("ngSubmit",function(){return d(s),m(n.crearDireccion())}),t(13,"div",10)(14,"div",11)(15,"label",12),a(16,"Alias"),r(),t(17,"input",13),v("ngModelChange",function(e){return d(s),g(n.nuevaDireccion.alias,e)||(n.nuevaDireccion.alias=e),m(e)}),r()(),t(18,"div",11)(19,"label",14),a(20,"Calle"),r(),t(21,"input",15),v("ngModelChange",function(e){return d(s),g(n.nuevaDireccion.calle,e)||(n.nuevaDireccion.calle=e),m(e)}),r()(),t(22,"div",16)(23,"label",17),a(24,"N\xFAmero"),r(),t(25,"input",18),v("ngModelChange",function(e){return d(s),g(n.nuevaDireccion.numero,e)||(n.nuevaDireccion.numero=e),m(e)}),r()(),t(26,"div",16)(27,"label",19),a(28,"Piso (opcional)"),r(),t(29,"input",20),v("ngModelChange",function(e){return d(s),g(n.nuevaDireccion.piso,e)||(n.nuevaDireccion.piso=e),m(e)}),r()(),t(30,"div",16)(31,"label",21),a(32,"Ciudad"),r(),t(33,"input",22),v("ngModelChange",function(e){return d(s),g(n.nuevaDireccion.ciudad,e)||(n.nuevaDireccion.ciudad=e),m(e)}),r()(),t(34,"div",16)(35,"label",23),a(36,"Provincia"),r(),t(37,"input",24),v("ngModelChange",function(e){return d(s),g(n.nuevaDireccion.provincia,e)||(n.nuevaDireccion.provincia=e),m(e)}),r()(),t(38,"div",16)(39,"label",25),a(40,"C\xF3digo Postal"),r(),t(41,"input",26),v("ngModelChange",function(e){return d(s),g(n.nuevaDireccion.codigoPostal,e)||(n.nuevaDireccion.codigoPostal=e),m(e)}),r()(),t(42,"div",16)(43,"label",27),a(44,"Pa\xEDs"),r(),t(45,"input",28),v("ngModelChange",function(e){return d(s),g(n.nuevaDireccion.pais,e)||(n.nuevaDireccion.pais=e),m(e)}),r()(),t(46,"div",29)(47,"button",30),D(48,"i",31),a(49," Guardar direcci\xF3n "),r()()()()()()}if(o&2){let s=x(6);l(4),b("ngIf",n.direcciones.length>0)("ngIfElse",s),l(13),u("ngModel",n.nuevaDireccion.alias),l(4),u("ngModel",n.nuevaDireccion.calle),l(4),u("ngModel",n.nuevaDireccion.numero),l(4),u("ngModel",n.nuevaDireccion.piso),l(4),u("ngModel",n.nuevaDireccion.ciudad),l(4),u("ngModel",n.nuevaDireccion.provincia),l(4),u("ngModel",n.nuevaDireccion.codigoPostal),l(4),u("ngModel",n.nuevaDireccion.pais)}},dependencies:[N,W,F,G,R,U,B,L,H,k,j],encapsulation:2})};export{K as SeleccionarDireccionComponent};
