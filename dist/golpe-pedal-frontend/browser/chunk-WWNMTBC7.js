import{a as D}from"./chunk-IN4BUU5G.js";import{a as B,b as p,c as M,d as $,g as q,h as z,i as R,j,k as G,l as U,m as k,n as A,s as H,u as L}from"./chunk-ND65VQ52.js";import{B as b,C as _,Da as w,Ea as O,G as h,Ha as T,Ia as V,J as a,M as n,N as e,O as s,S as F,W as r,X as E,ea as d,pa as y,qa as I,ua as x,ya as N,z as l}from"./chunk-YAXSTRSO.js";var f=m=>({"is-invalid":m});function J(m,i){if(m&1&&(n(0,"option",15),r(1),e()),m&2){let t=i.$implicit;a("ngValue",t.id),l(),E(t.nombre)}}function K(m,i){if(m&1&&(n(0,"option",15),r(1),e()),m&2){let t=i.$implicit;a("ngValue",t.id),l(),E(t.nombre)}}function Q(m,i){if(m&1&&(n(0,"option",15),r(1),e()),m&2){let t=i.$implicit;a("ngValue",t.id),l(),E(t.nombre)}}var P=class m{constructor(i,t,o,c){this.fb=i;this.router=t;this.componentesService=o;this.http=c}formulario;marcas=[];tiposComponente=[];tiposBicicleta=[];imagenSeleccionada=null;apiUrl=V.apiUrl;ngOnInit(){window.scrollTo({top:0}),this.formulario=this.fb.group({nombre:["",p.required],descripcion:["",p.required],precio:[null,[p.required,p.pattern(/^\d+(\.\d{1,2})?$/),p.min(.01)]],tipoComponenteId:[null,p.required],marcaId:[null,p.required],tipoBicicletaId:[null,p.required]}),this.cargarSelects()}cargarSelects(){this.http.get(`${this.apiUrl}/marcas`).subscribe({next:i=>this.marcas=i,error:i=>console.error("Error al cargar marcas:",i)}),this.http.get(`${this.apiUrl}/tipos-componente`).subscribe({next:i=>this.tiposComponente=i,error:i=>console.error("Error al cargar tipos de componente:",i)}),this.http.get(`${this.apiUrl}/tipos-bicicleta`).subscribe({next:i=>this.tiposBicicleta=i,error:i=>console.error("Error al cargar tipos de bicicleta:",i)})}guardar(){if(this.formulario.invalid)return;let i=this.formulario.getRawValue();this.componentesService.crearComponente(i).subscribe({next:t=>{let o=t?.id;this.imagenSeleccionada&&typeof o=="number"?this.subirImagen(o):this.router.navigate(["/dashboard/componentes"])},error:t=>console.error("Error al crear componente:",t)})}onFileSelected(i){let t=i.target;t.files&&t.files[0]&&(this.imagenSeleccionada=t.files[0])}subirImagen(i){let t=new FormData;t.append("file",this.imagenSeleccionada),this.http.post(`${this.apiUrl}/componentes/${i}/imagen`,t).subscribe({next:()=>this.router.navigate(["/dashboard/componentes"]),error:o=>{console.error("Error al subir imagen:",o)}})}static \u0275fac=function(t){return new(t||m)(b(H),b(w),b(D),b(N))};static \u0275cmp=_({type:m,selectors:[["app-formulario-componente"]],decls:62,vars:26,consts:[[1,"container","mt-4","d-flex","justify-content-center"],[1,"w-100",2,"max-width","640px"],[1,"mb-4","texto-grande","fw-bold"],[1,"bi","bi-plus-circle","me-2"],[1,"bg-white","p-4","rounded-3","sombra-suave","borde-claro",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","nombre",1,"form-label","fw-semibold"],["id","nombre","type","text","formControlName","nombre",1,"form-control","input-estilizado",3,"ngClass"],[1,"invalid-feedback"],["for","descripcion",1,"form-label","fw-semibold"],["id","descripcion","rows","3","formControlName","descripcion",1,"form-control","input-estilizado",3,"ngClass"],["for","precio",1,"form-label","fw-semibold"],["id","precio","type","number","min","0.01","step","0.01","formControlName","precio",1,"form-control","input-estilizado",3,"ngClass"],[1,"form-label","fw-semibold"],["formControlName","tipoComponenteId",1,"form-select","input-estilizado",3,"ngClass"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["formControlName","marcaId",1,"form-select","input-estilizado",3,"ngClass"],["formControlName","tipoBicicletaId",1,"form-select","input-estilizado",3,"ngClass"],["type","file","accept","image/*",1,"form-control","input-estilizado",3,"change"],[1,"d-flex","justify-content-between","mt-4"],["type","submit",1,"btn","btn-secundario",3,"disabled"],[1,"bi","bi-check-circle","me-1"],["routerLink","/dashboard/componentes",1,"btn","btn-outline-dark"],[1,"bi","bi-x-circle","me-1"]],template:function(t,o){if(t&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),s(3,"i",3),r(4,"Nuevo Componente "),e(),n(5,"form",4),F("ngSubmit",function(){return o.guardar()}),n(6,"div",5)(7,"label",6),r(8,"Nombre"),e(),s(9,"input",7),n(10,"div",8),r(11,"El nombre es obligatorio."),e()(),n(12,"div",5)(13,"label",9),r(14,"Descripci\xF3n"),e(),s(15,"textarea",10),n(16,"div",8),r(17,"La descripci\xF3n es obligatoria."),e()(),n(18,"div",5)(19,"label",11),r(20,"Precio (\u20AC)"),e(),s(21,"input",12),n(22,"div",8),r(23,"Introduce un precio v\xE1lido mayor que cero."),e()(),n(24,"div",5)(25,"label",13),r(26,"Tipo de Componente"),e(),n(27,"select",14)(28,"option",15),r(29,"-- Seleccionar --"),e(),h(30,J,2,2,"option",16),e(),n(31,"div",8),r(32,"Selecciona un tipo de componente."),e()(),n(33,"div",5)(34,"label",13),r(35,"Marca"),e(),n(36,"select",17)(37,"option",15),r(38,"-- Seleccionar --"),e(),h(39,K,2,2,"option",16),e(),n(40,"div",8),r(41,"Selecciona una marca."),e()(),n(42,"div",5)(43,"label",13),r(44,"Tipo de Bicicleta"),e(),n(45,"select",18)(46,"option",15),r(47,"-- Seleccionar --"),e(),h(48,Q,2,2,"option",16),e(),n(49,"div",8),r(50,"Selecciona un tipo de bicicleta."),e()(),n(51,"div",5)(52,"label",13),r(53,"Imagen del Componente"),e(),n(54,"input",19),F("change",function(u){return o.onFileSelected(u)}),e()(),n(55,"div",20)(56,"button",21),s(57,"i",22),r(58,"Crear Componente "),e(),n(59,"a",23),s(60,"i",24),r(61,"Cancelar "),e()()()()()),t&2){let c,u,g,v,C,S;l(5),a("formGroup",o.formulario),l(4),a("ngClass",d(14,f,((c=o.formulario.get("nombre"))==null?null:c.invalid)&&((c=o.formulario.get("nombre"))==null?null:c.touched))),l(6),a("ngClass",d(16,f,((u=o.formulario.get("descripcion"))==null?null:u.invalid)&&((u=o.formulario.get("descripcion"))==null?null:u.touched))),l(6),a("ngClass",d(18,f,((g=o.formulario.get("precio"))==null?null:g.invalid)&&((g=o.formulario.get("precio"))==null?null:g.touched))),l(6),a("ngClass",d(20,f,((v=o.formulario.get("tipoComponenteId"))==null?null:v.invalid)&&((v=o.formulario.get("tipoComponenteId"))==null?null:v.touched))),l(),a("ngValue",null),l(2),a("ngForOf",o.tiposComponente),l(6),a("ngClass",d(22,f,((C=o.formulario.get("marcaId"))==null?null:C.invalid)&&((C=o.formulario.get("marcaId"))==null?null:C.touched))),l(),a("ngValue",null),l(2),a("ngForOf",o.marcas),l(6),a("ngClass",d(24,f,((S=o.formulario.get("tipoBicicletaId"))==null?null:S.invalid)&&((S=o.formulario.get("tipoBicicletaId"))==null?null:S.touched))),l(),a("ngValue",null),l(2),a("ngForOf",o.tiposBicicleta),l(8),a("disabled",o.formulario.invalid)}},dependencies:[x,y,I,L,q,U,k,B,z,G,M,$,A,R,j,T,O],encapsulation:2})};export{P as FormularioComponenteComponent};
