import{k as r}from"./chunk-YAXSTRSO.js";var n=class o{getRol(){let t=localStorage.getItem("token");if(!t)return"";try{return JSON.parse(atob(t.split(".")[1])).rol||""}catch(e){return console.error("\u274C Error leyendo el rol desde el token:",e),""}}getEmail(){let t=localStorage.getItem("token");if(!t)return"";try{return JSON.parse(atob(t.split(".")[1])).sub||""}catch(e){return console.error("\u274C Error leyendo el email desde el token:",e),""}}isAdmin(){return this.getRol()==="ROLE_ADMIN"}isCliente(){return this.getRol()==="ROLE_CLIENTE"}isAuthenticated(){return!!localStorage.getItem("token")&&!this.isTokenExpired()}isTokenExpired(){let t=localStorage.getItem("token");if(!t)return!0;try{let a=JSON.parse(atob(t.split(".")[1])).exp;return Math.floor(Date.now()/1e3)>a}catch(e){return console.error("\u274C Error comprobando expiraci\xF3n del token:",e),!0}}static \u0275fac=function(e){return new(e||o)};static \u0275prov=r({token:o,factory:o.\u0275fac,providedIn:"root"})};export{n as a};
