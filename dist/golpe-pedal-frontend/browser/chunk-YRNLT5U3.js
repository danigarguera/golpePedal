import{a as L,c as U,f as j,k as z,l as $,m as q,t as G}from"./chunk-ND65VQ52.js";import{$ as x,B as y,C as F,Da as H,G as m,Ia as I,J as d,M as a,N as o,O as _,R as S,S as u,T as p,W as c,X as h,aa as E,ba as V,ea as D,fa as C,ga as w,ha as T,ia as k,pa as M,q as g,qa as P,r as f,ra as O,sa as N,ta as W,ua as B,xa as R,ya as A,z as s}from"./chunk-YAXSTRSO.js";var b=(i,t)=>({"bi-caret-up-fill":i,"bi-caret-down-fill":t}),K=i=>[i,"EUR","symbol","1.2-2","es-ES"];function Q(i,t){if(i&1&&(a(0,"option",17),c(1),o()),i&2){let e=t.$implicit;d("value",e.id),s(),h(e.email)}}function X(i,t){i&1&&(a(0,"div",18),c(1,"Cargando ventas..."),o())}function Y(i,t){i&1&&(a(0,"div",19),c(1," No hay ventas para mostrar. "),o())}function Z(i,t){if(i&1&&_(0,"i",25),i&2){let e=p(2);d("ngClass",C(1,b,e.sortDirection==="asc",e.sortDirection==="desc"))}}function ee(i,t){if(i&1&&_(0,"i",25),i&2){let e=p(2);d("ngClass",C(1,b,e.sortDirection==="asc",e.sortDirection==="desc"))}}function te(i,t){if(i&1&&_(0,"i",25),i&2){let e=p(2);d("ngClass",C(1,b,e.sortDirection==="asc",e.sortDirection==="desc"))}}function ie(i,t){if(i&1&&_(0,"i",25),i&2){let e=p(2);d("ngClass",C(1,b,e.sortDirection==="asc",e.sortDirection==="desc"))}}function ne(i,t){if(i&1&&_(0,"i",25),i&2){let e=p(2);d("ngClass",C(1,b,e.sortDirection==="asc",e.sortDirection==="desc"))}}function ae(i,t){if(i&1){let e=S();a(0,"tr",26),u("click",function(){let r=g(e).$implicit,l=p(2);return f(l.irADetalle(r.id))}),a(1,"td",27),c(2),o(),a(3,"td",28),c(4),w(5,"date"),o(),a(6,"td",29),c(7),o(),a(8,"td",30),c(9),o(),a(10,"td",31),c(11),w(12,"currency"),o()()}if(i&2){let e=t.$implicit;s(2),h(e.id),s(2),h(T(5,5,e.fecha,"short")),s(3),h(e.cliente),s(2),h(e.empleado),s(2),h(k(12,8,D(14,K,e.total)))}}function oe(i,t){if(i&1){let e=S();a(0,"table",20)(1,"thead",21)(2,"tr")(3,"th",22),u("click",function(){g(e);let r=p();return f(r.ordenarPor("id"))}),c(4," ID "),m(5,Z,1,4,"i",23),o(),a(6,"th",22),u("click",function(){g(e);let r=p();return f(r.ordenarPor("fecha"))}),c(7," Fecha "),m(8,ee,1,4,"i",23),o(),a(9,"th",22),u("click",function(){g(e);let r=p();return f(r.ordenarPor("cliente"))}),c(10," Cliente "),m(11,te,1,4,"i",23),o(),a(12,"th",22),u("click",function(){g(e);let r=p();return f(r.ordenarPor("empleado"))}),c(13," Empleado "),m(14,ie,1,4,"i",23),o(),a(15,"th",22),u("click",function(){g(e);let r=p();return f(r.ordenarPor("total"))}),c(16," Total "),m(17,ne,1,4,"i",23),o()()(),a(18,"tbody"),m(19,ae,13,16,"tr",24),o()()}if(i&2){let e=p();s(5),d("ngIf",e.sortField==="id"),s(3),d("ngIf",e.sortField==="fecha"),s(3),d("ngIf",e.sortField==="cliente"),s(3),d("ngIf",e.sortField==="empleado"),s(3),d("ngIf",e.sortField==="total"),s(2),d("ngForOf",e.ventas)}}var J=class i{constructor(t,e){this.http=t;this.router=e}ventas=[];empleados=[];empleadoSeleccionado="";desde="";hasta="";cargando=!1;sortField="";sortDirection="asc";ngOnInit(){this.cargarEmpleados(),this.cargarVentas()}cargarEmpleados(){this.http.get(`${I.apiUrl}/usuarios/empleados`).subscribe({next:t=>{this.empleados=t},error:t=>{console.error("Error al cargar empleados:",t)}})}cargarVentas(){this.cargando=!0;let t=new R;this.desde&&(t=t.set("desde",this.desde)),this.hasta&&(t=t.set("hasta",this.hasta)),this.empleadoSeleccionado&&(t=t.set("empleadoId",this.empleadoSeleccionado)),this.http.get(`${I.apiUrl}/pedidos/por-empleados`,{params:t}).subscribe({next:e=>{this.ventas=e,this.cargando=!1},error:e=>{console.error("Error al cargar ventas:",e),this.cargando=!1}})}ordenarPor(t){this.sortField===t?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=t,this.sortDirection="asc"),this.ventas.sort((e,n)=>{let r=e[t],l=n[t];return r<l?this.sortDirection==="asc"?-1:1:r>l?this.sortDirection==="asc"?1:-1:0})}irADetalle(t){this.router.navigate(["/dashboard/detalle-venta",t])}exportarCSV(){let t=`Fecha,Cliente,Empleado,Total
`,e=this.ventas.map(v=>`${v.fecha},${v.cliente},${v.empleado},${v.total}`).join(`
`),n=t+e,r=new Blob([n],{type:"text/csv"}),l=document.createElement("a");l.href=URL.createObjectURL(r),l.download="ventas-empleados.csv",l.click()}static \u0275fac=function(e){return new(e||i)(y(A),y(H))};static \u0275cmp=F({type:i,selectors:[["app-ventas-empleados"]],decls:27,vars:7,consts:[[1,"container","mt-4"],[1,"mb-4","texto-grande","fw-bold"],[1,"bi","bi-bar-chart-line","me-2"],[1,"row","g-3","align-items-end","sombra-suave","p-3","borde-claro","rounded-3"],[1,"col-md-3"],[1,"form-label"],["type","date",1,"form-control","input-estilizado",3,"ngModelChange","ngModel"],[1,"col-md-4"],[1,"form-select","input-estilizado",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-2","text-end"],[1,"btn","btn-primario","w-100",3,"click"],[1,"bi","bi-search","me-1"],["class","mt-4 text-muted",4,"ngIf"],["class","alert alert-warning mt-4",4,"ngIf"],["class","table table-bordered table-hover mt-4",4,"ngIf"],[3,"value"],[1,"mt-4","text-muted"],[1,"alert","alert-warning","mt-4"],[1,"table","table-bordered","table-hover","mt-4"],[1,"table-light"],[1,"sortable",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],["style","cursor: pointer",3,"click",4,"ngFor","ngForOf"],[1,"bi",3,"ngClass"],[2,"cursor","pointer",3,"click"],["data-label","ID"],["data-label","Fecha"],["data-label","Cliente"],["data-label","Empleado"],["data-label","Total"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"h2",1),_(2,"i",2),c(3," Ventas por empleados "),o(),a(4,"div",3)(5,"div",4)(6,"label",5),c(7,"Desde"),o(),a(8,"input",6),V("ngModelChange",function(l){return E(n.desde,l)||(n.desde=l),l}),o()(),a(9,"div",4)(10,"label",5),c(11,"Hasta"),o(),a(12,"input",6),V("ngModelChange",function(l){return E(n.hasta,l)||(n.hasta=l),l}),o()(),a(13,"div",7)(14,"label",5),c(15,"Empleado"),o(),a(16,"select",8),V("ngModelChange",function(l){return E(n.empleadoSeleccionado,l)||(n.empleadoSeleccionado=l),l}),a(17,"option",9),c(18,"Todos"),o(),m(19,Q,2,2,"option",10),o()(),a(20,"div",11)(21,"button",12),u("click",function(){return n.cargarVentas()}),_(22,"i",13),c(23," Filtrar "),o()()(),m(24,X,2,0,"div",14)(25,Y,2,0,"div",15)(26,oe,20,6,"table",16),o()),e&2&&(s(8),x("ngModel",n.desde),s(4),x("ngModel",n.hasta),s(4),x("ngModel",n.empleadoSeleccionado),s(3),d("ngForOf",n.empleados),s(5),d("ngIf",n.cargando),s(),d("ngIf",!n.ventas.length&&!n.cargando),s(),d("ngIf",n.ventas.length))},dependencies:[B,M,P,O,W,N,G,$,q,L,z,U,j],encapsulation:2})};export{J as VentasEmpleadosComponent};
