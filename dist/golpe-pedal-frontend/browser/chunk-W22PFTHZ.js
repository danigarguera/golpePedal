import{a as A}from"./chunk-IN4BUU5G.js";import{c as N,f as L,k as W,l as R,m as V,t as B}from"./chunk-ND65VQ52.js";import{$ as b,B as C,C as E,Da as w,Ea as P,G as f,J as m,M as o,N as i,O as c,R as F,S as d,T as _,W as r,X as u,aa as h,ba as v,ea as S,ga as M,ia as O,pa as k,q as T,qa as I,r as y,ra as D,ta as x,ua as G,z as a}from"./chunk-YAXSTRSO.js";var z=l=>[l,"EUR","symbol","1.2-2","es-ES"],j=l=>["/dashboard/componentes/modificar",l];function U(l,t){if(l&1&&(o(0,"option",17),r(1),i()),l&2){let e=t.$implicit;m("value",e),a(),u(e)}}function H(l,t){if(l&1&&(o(0,"option",17),r(1),i()),l&2){let e=t.$implicit;m("value",e),a(),u(e)}}function J(l,t){if(l&1){let e=F();o(0,"button",27),d("click",function(){T(e);let p=_().$implicit,s=_();return y(s.eliminar(p.id))}),c(1,"i",28),r(2," Eliminar "),i()}}function K(l,t){if(l&1&&(o(0,"tr")(1,"td",18),r(2),i(),o(3,"td",19),r(4),i(),o(5,"td",20),r(6),M(7,"currency"),i(),o(8,"td",21),r(9),i(),o(10,"td",22),r(11),i(),o(12,"td",23)(13,"a",24),c(14,"i",25),r(15," Editar "),i(),f(16,J,3,0,"button",26),i()()),l&2){let e=t.$implicit;a(2),u(e.nombre),a(2),u(e.descripcion),a(2),u(O(7,7,S(13,z,e.precio))),a(3),u(e.tipo),a(2),u(e.marca),a(2),m("routerLink",S(15,j,e.id)),a(3),m("ngIf",e.id!==void 0)}}var q=class l{constructor(t,e){this.componentesService=t;this.router=e}componentes=[];componentesFiltrados=[];filtroTipo="";filtroMarca="";tiposDisponibles=[];marcasDisponibles=[];ordenCampo="";ordenAscendente=!0;ngOnInit(){this.cargarComponentes()}cargarComponentes(){this.componentesService.obtenerComponentesDTO().subscribe({next:t=>{this.componentes=t,this.actualizarFiltrosDisponibles(t),this.aplicarFiltros()},error:t=>console.error("\u274C Error al cargar componentes:",t)})}actualizarFiltrosDisponibles(t){this.tiposDisponibles=Array.from(new Set(t.map(e=>e.tipo).filter(e=>typeof e=="string"))),this.marcasDisponibles=Array.from(new Set(t.map(e=>e.marca).filter(e=>typeof e=="string")))}aplicarFiltros(){this.componentesFiltrados=this.componentes.filter(t=>{let e=this.filtroTipo?t.tipo===this.filtroTipo:!0,n=this.filtroMarca?t.marca===this.filtroMarca:!0;return e&&n}),this.ordenCampo&&this.ordenarPor(this.ordenCampo,!1)}eliminar(t){confirm("\xBFEst\xE1s seguro de que quieres eliminar este componente?")&&this.componentesService.eliminar(t).subscribe({next:()=>this.cargarComponentes(),error:e=>console.error("\u274C Error al eliminar componente:",e)})}ordenarPor(t,e=!0){t&&(this.ordenCampo===t&&e?this.ordenAscendente=!this.ordenAscendente:e&&(this.ordenCampo=t,this.ordenAscendente=!0),this.componentesFiltrados.sort((n,p)=>{let s=n[t],g=p[t];return s==null?1:g==null?-1:this.ordenAscendente?String(s).localeCompare(String(g)):String(g).localeCompare(String(s))}))}getIconoOrden(t){return this.ordenCampo!==t?"":this.ordenAscendente?"bi-caret-up-fill":"bi-caret-down-fill"}limpiarFiltros(){this.filtroTipo="",this.filtroMarca="",this.aplicarFiltros()}static \u0275fac=function(e){return new(e||l)(C(A),C(w))};static \u0275cmp=E({type:l,selectors:[["app-gestionar-componentes"]],decls:45,vars:10,consts:[[1,"container","mt-4"],[1,"mb-4","texto-grande","fw-bold"],[1,"bi","bi-box-seam","me-2"],[1,"row","g-3","align-items-end","sombra-suave","p-3","borde-claro","rounded-3","mb-4"],[1,"col-md-3"],["routerLink","/dashboard/componentes/nuevo",1,"btn","btn-secundario","w-100"],[1,"bi","bi-plus-circle","me-1"],[1,"col-md-4"],["for","filtroTipo",1,"form-label"],[1,"form-select","input-estilizado",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","filtroMarca",1,"form-label"],[1,"table","table-striped"],[1,"sortable",3,"click"],[1,"bi",3,"ngClass"],[4,"ngFor","ngForOf"],[3,"value"],["data-label","Nombre"],["data-label","Descripci\xF3n"],["data-label","Precio"],["data-label","Tipo"],["data-label","Marca"],["data-label","Acciones"],[1,"btn","btn-sm","btn-primario","me-2",3,"routerLink"],[1,"bi","bi-pencil-square"],["class","btn btn-sm btn-danger",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"bi","bi-trash"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"h2",1),c(2,"i",2),r(3," Gesti\xF3n de Componentes "),i(),o(4,"div",3)(5,"div",4)(6,"a",5),c(7,"i",6),r(8," Nuevo Componente "),i()(),o(9,"div",7)(10,"label",8),r(11,"Filtrar por tipo"),i(),o(12,"select",9),v("ngModelChange",function(s){return h(n.filtroTipo,s)||(n.filtroTipo=s),s}),d("change",function(){return n.aplicarFiltros()}),o(13,"option",10),r(14,"Todos"),i(),f(15,U,2,2,"option",11),i()(),o(16,"div",7)(17,"label",12),r(18,"Filtrar por marca"),i(),o(19,"select",9),v("ngModelChange",function(s){return h(n.filtroMarca,s)||(n.filtroMarca=s),s}),d("change",function(){return n.aplicarFiltros()}),o(20,"option",10),r(21,"Todas"),i(),f(22,H,2,2,"option",11),i()()(),o(23,"table",13)(24,"thead")(25,"tr")(26,"th",14),d("click",function(){return n.ordenarPor("nombre")}),r(27," Nombre "),c(28,"i",15),i(),o(29,"th",14),d("click",function(){return n.ordenarPor("descripcion")}),r(30," Descripci\xF3n "),c(31,"i",15),i(),o(32,"th",14),d("click",function(){return n.ordenarPor("precio")}),r(33," Precio "),c(34,"i",15),i(),o(35,"th",14),d("click",function(){return n.ordenarPor("tipo")}),r(36," Tipo "),c(37,"i",15),i(),o(38,"th",14),d("click",function(){return n.ordenarPor("marca")}),r(39," Marca "),c(40,"i",15),i(),o(41,"th"),r(42,"Acciones"),i()()(),o(43,"tbody"),f(44,K,17,17,"tr",16),i()()()),e&2&&(a(12),b("ngModel",n.filtroTipo),a(3),m("ngForOf",n.tiposDisponibles),a(4),b("ngModel",n.filtroMarca),a(3),m("ngForOf",n.marcasDisponibles),a(6),m("ngClass",n.getIconoOrden("nombre")),a(3),m("ngClass",n.getIconoOrden("descripcion")),a(3),m("ngClass",n.getIconoOrden("precio")),a(3),m("ngClass",n.getIconoOrden("tipo")),a(3),m("ngClass",n.getIconoOrden("marca")),a(4),m("ngForOf",n.componentesFiltrados))},dependencies:[G,k,I,D,x,B,R,V,W,N,L,P],encapsulation:2})};export{q as GestionarComponentesComponent};
