<div class="container mt-4" *ngIf="direccion && carrito.length > 0; else cargando">
  <h2>Revisar y confirmar pedido</h2>

  <div class="card mt-4">
    <div class="card-header bg-light">
      <strong>Dirección de envío</strong>
    </div>
    <div class="card-body">
      <p><strong>{{ direccion.alias }}</strong></p>
      <p>
        {{ direccion.calle }}, {{ direccion.numero }}
        <span *ngIf="direccion.piso">, piso {{ direccion.piso }}</span><br>
        {{ direccion.codigoPostal }} {{ direccion.ciudad }} ({{ direccion.provincia }})<br>
        {{ direccion.pais }}
      </p>
    </div>
  </div>

  <div class="mt-4">
    <h4>Productos en el pedido</h4>
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>Producto</th>
          <th>Cantidad</th>
          <th>Precio unitario</th>
          <th>Subtotal</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of carrito">
          <td>{{ item.nombre }}</td>
          <td>{{ item.cantidad }}</td>
          <td>{{ item.precio | currency:'EUR' }}</td>
          <td>{{ item.precio * item.cantidad | currency:'EUR' }}</td>
        </tr>
      </tbody>
    </table>

    <div class="text-end">
      <h5>Total: {{ totalPedido | currency:'EUR' }}</h5>
    </div>
  </div>

  <div class="mt-4 text-end">
    <button class="btn btn-success" (click)="finalizarCompra()">Finalizar compra</button>
  </div>
</div>

<ng-template #cargando>
  <div class="alert alert-warning mt-4">
    Cargando datos del pedido o sesión inválida. Por favor vuelve al carrito.
  </div>
</ng-template>
