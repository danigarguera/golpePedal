<!-- BACKDROP -->
<div class="modal-backdrop show fade" style="background: rgba(0,0,0,0.5); position: fixed; inset: 0; z-index: 1040;"></div>

<!-- MODAL -->
<div class="modal d-block" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-4 rounded-4 sombra-suave">

      <!-- CABECERA -->
      <div class="modal-header border-0">
        <h5 class="modal-title texto-grande">
          {{ mostrarRegistro ? 'Registro de Usuario' : 'Iniciar Sesión' }}
        </h5>
      </div>

      <!-- BODY -->
      <div class="modal-body">
        <!-- FORMULARIO LOGIN -->
        <form *ngIf="!mostrarRegistro" (ngSubmit)="login()">
          <div class="mb-3">
            <label>Email</label>
            <input type="email" [(ngModel)]="email" name="email" class="form-control input-estilizado" required />
          </div>

          <div class="mb-3">
            <label>Contraseña</label>
            <input type="password" [(ngModel)]="password" name="password" class="form-control input-estilizado" required />
          </div>

          <button type="submit" class="btn btn-primario w-100">
            <i class="bi bi-box-arrow-in-right me-2"></i> Iniciar sesión
          </button>

          <div *ngIf="error" class="text-danger mt-2">{{ error }}</div>
        </form>

        <!-- FORMULARIO REGISTRO -->
        <form *ngIf="mostrarRegistro" (ngSubmit)="registrarUsuario()" novalidate>
          <div class="mb-3">
            <label>Nombre</label>
            <input type="text" [(ngModel)]="usuario.nombre" name="nombre" class="form-control input-estilizado" required />
          </div>

          <div class="mb-3">
            <label>Primer Apellido</label>
            <input type="text" [(ngModel)]="usuario.apellido1" name="apellido1" class="form-control input-estilizado" required />
          </div>

          <div class="mb-3">
            <label>Segundo Apellido</label>
            <input type="text" [(ngModel)]="usuario.apellido2" name="apellido2" class="form-control input-estilizado" />
          </div>

          <div class="mb-3">
            <label>DNI</label>
            <input type="text" [(ngModel)]="usuario.dni" name="dni" class="form-control input-estilizado" required pattern="^[0-9]{8}[A-Z]$" />
          </div>

          <div class="mb-3">
            <label>Teléfono</label>
            <input type="text" [(ngModel)]="usuario.telefono" name="telefono" class="form-control input-estilizado" required pattern="^[0-9]{9}$" />
          </div>

          <div class="mb-3">
            <label>Email</label>
            <input type="email" [(ngModel)]="usuario.email" name="email" class="form-control input-estilizado" required />
          </div>

          <div class="mb-3">
            <label>Contraseña</label>
            <input type="password" [(ngModel)]="usuario.password" name="password" class="form-control input-estilizado" required minlength="6" />
          </div>

          <button type="submit" class="btn btn-primario w-100">
            <i class="bi bi-person-check"></i> Registrarse
          </button>

          <div *ngIf="mensaje" class="text-success mt-2">{{ mensaje }}</div>
          <div *ngIf="error" class="text-danger mt-2">{{ error }}</div>
        </form>
      </div>

      <!-- FOOTER SIEMPRE VISIBLE -->
      <div class="modal-footer border-0 justify-content-between">
        <span>{{ mostrarRegistro ? '¿Ya tienes cuenta?' : '¿No tienes cuenta?' }}</span>
        <button class="btn btn-secundario btn-sm" (click)="toggleRegistro()">
          <i [class]="mostrarRegistro ? 'bi bi-box-arrow-in-left' : 'bi bi-person-plus'"></i>
          {{ mostrarRegistro ? 'Volver a login' : 'Crear cuenta' }}
        </button>
      </div>

    </div>
  </div>
</div>
