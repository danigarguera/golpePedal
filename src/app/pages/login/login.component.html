<!-- FONDO OSCURO -->
<div class="modal-backdrop show fade" style="background: rgba(0,0,0,0.5); position: fixed; inset: 0; z-index: 1040;">
</div>

<!-- CONTENEDOR DE MODALES -->
<div class="modal d-block" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-4 rounded-4 sombra-suave">

      <!-- 🔄 Cabecera dinámica -->
      <div class="modal-header border-0">
        <h5 class="modal-title texto-grande">
          {{ mostrarRegistro ? 'Registro de Usuario' : 'Iniciar Sesión' }}
        </h5>
      </div>

      <div class="modal-body">
        <!-- ✅ FORMULARIO LOGIN -->
        <form *ngIf="!mostrarRegistro" (ngSubmit)="login()">
          <div class="mb-3">
            <label for="email">Correo electrónico</label>
            <input type="email" id="email" [(ngModel)]="email" name="email" required
              class="form-control input-estilizado" />
          </div>

          <div class="mb-3">
            <label for="password">Contraseña</label>
            <input type="password" id="password" [(ngModel)]="password" name="password" required
              class="form-control input-estilizado" />
          </div>

          <button type="submit" class="btn btn-secundario w-100">
            <i class="bi bi-box-arrow-in-right me-2"></i> Iniciar sesión
          </button>

          <div *ngIf="error" class="mt-3 text-danger">{{ error }}</div>
        </form>

        <!-- ✅ FORMULARIO REGISTRO -->
        <form *ngIf="mostrarRegistro" (ngSubmit)="registrarUsuario()" #registroForm="ngForm" novalidate>
          <div class="mb-3">
            <label>Nombre</label>
            <input type="text" name="nombre" [(ngModel)]="usuario.nombre" class="form-control input-estilizado"
              required />
          </div>

          <div class="mb-3">
            <label>Apellido 1</label>
            <input type="text" name="apellido1" [(ngModel)]="usuario.apellido1" class="form-control input-estilizado"
              required />
          </div>

          <div class="mb-3">
            <label>Apellido 2</label>
            <input type="text" name="apellido2" [(ngModel)]="usuario.apellido2" class="form-control input-estilizado" />
          </div>

          <div class="mb-3">
            <label>DNI</label>
            <input type="text" name="dni" [(ngModel)]="usuario.dni" class="form-control input-estilizado" required
              pattern="^[0-9]{8}[A-Z]$" />
          </div>

          <div class="mb-3">
            <label>Teléfono</label>
            <input type="text" name="telefono" [(ngModel)]="usuario.telefono" class="form-control input-estilizado"
              required pattern="^[0-9]{9}$" />
          </div>

          <div class="mb-3">
            <label>Email</label>
            <input type="email" name="email" [(ngModel)]="usuario.email" class="form-control input-estilizado"
              required />
          </div>

          <div class="mb-3">
            <label>Contraseña</label>
            <input type="password" name="password" [(ngModel)]="usuario.password" class="form-control input-estilizado"
              required minlength="6" />
          </div>

          <button type="submit" class="btn btn-secundario w-100">Registrarse</button>

          <div *ngIf="mensaje" class="text-success mt-2">{{ mensaje }}</div>
          <div *ngIf="error" class="text-danger mt-2">{{ error }}</div>
        </form>
      </div>

      <!-- 🔁 Pie con botón para alternar -->
      <div class="modal-footer border-0 justify-content-between">
        <span>{{ mostrarRegistro ? '¿Ya tienes cuenta?' : '¿No tienes cuenta?' }}</span>

        <button class="btn btn-outline-light btn-sm" (click)="toggleRegistro()">
          <i [class]="mostrarRegistro ? 'bi bi-box-arrow-in-left' : 'bi bi-person-plus'"></i>
          {{ mostrarRegistro ? 'Volver a login' : 'Registrarse' }}
        </button>
      </div>

    </div>
  </div>
</div>