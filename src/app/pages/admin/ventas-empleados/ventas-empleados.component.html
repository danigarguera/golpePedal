<div class="container mt-4">
  <h2 class="mb-4 texto-grande fw-bold">
    <i class="bi bi-bar-chart-line me-2"></i> Ventas por empleados
  </h2>

  <!-- Filtros -->
  <div class="row g-3 align-items-end sombra-suave p-3 borde-claro rounded-3">
    <div class="col-md-3">
      <label class="form-label">Desde</label>
      <input type="date" [(ngModel)]="desde" class="form-control input-estilizado" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Hasta</label>
      <input type="date" [(ngModel)]="hasta" class="form-control input-estilizado" />
    </div>
    <div class="col-md-4">
      <label class="form-label">Empleado</label>
      <select [(ngModel)]="empleadoSeleccionado" class="form-select input-estilizado">
        <option value="">Todos</option>
        <option *ngFor="let emp of empleados" [value]="emp.id">{{ emp.email }}</option>
      </select>
    </div>
    <div class="col-md-2 text-end">
      <button class="btn btn-primario w-100" (click)="cargarVentas()">
        <i class="bi bi-search me-1"></i> Filtrar
      </button>
    </div>
  </div>

  <!-- Estado de carga -->
  <div *ngIf="cargando" class="mt-4 text-muted">Cargando ventas...</div>

  <!-- Sin resultados -->
  <div *ngIf="!ventas.length && !cargando" class="alert alert-warning mt-4">
    No hay ventas para mostrar.
  </div>

  <!-- Tabla -->
  <table *ngIf="ventas.length" class="table table-bordered table-hover mt-4">
    <thead class="table-light">
      <tr>
        <th class="sortable" (click)="ordenarPor('id')">
          ID
          <i *ngIf="sortField === 'id'" class="bi" [ngClass]="{
            'bi-caret-up-fill': sortDirection === 'asc',
            'bi-caret-down-fill': sortDirection === 'desc'
          }"></i>
        </th>
        <th class="sortable" (click)="ordenarPor('fecha')">
          Fecha
          <i *ngIf="sortField === 'fecha'" class="bi" [ngClass]="{
            'bi-caret-up-fill': sortDirection === 'asc',
            'bi-caret-down-fill': sortDirection === 'desc'
          }"></i>
        </th>
        <th class="sortable" (click)="ordenarPor('cliente')">
          Cliente
          <i *ngIf="sortField === 'cliente'" class="bi" [ngClass]="{
            'bi-caret-up-fill': sortDirection === 'asc',
            'bi-caret-down-fill': sortDirection === 'desc'
          }"></i>
        </th>
        <th class="sortable" (click)="ordenarPor('empleado')">
          Empleado
          <i *ngIf="sortField === 'empleado'" class="bi" [ngClass]="{
            'bi-caret-up-fill': sortDirection === 'asc',
            'bi-caret-down-fill': sortDirection === 'desc'
          }"></i>
        </th>
        <th class="sortable" (click)="ordenarPor('total')">
          Total
          <i *ngIf="sortField === 'total'" class="bi" [ngClass]="{
            'bi-caret-up-fill': sortDirection === 'asc',
            'bi-caret-down-fill': sortDirection === 'desc'
          }"></i>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let venta of ventas" (click)="irADetalle(venta.id)" style="cursor: pointer">
        <td data-label="ID">{{ venta.id }}</td>
        <td data-label="Fecha">{{ venta.fecha | date: 'short' }}</td>
        <td data-label="Cliente">{{ venta.cliente }}</td>
        <td data-label="Empleado">{{ venta.empleado }}</td>
        <td data-label="Total">{{ venta.total | currency: 'EUR':'symbol':'1.2-2':'es-ES' }}</td>
      </tr>
    </tbody>

  </table>
</div>